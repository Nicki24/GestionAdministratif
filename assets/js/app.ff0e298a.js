(function(){"use strict";var e={5151:function(e,t,a){var r=a(5130),s=a(6768);function o(e,t,a,r,o,n){const i=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.Wv)((0,s.$y)(r.currentLayout),null,{default:(0,s.k6)(()=>[(0,s.bF)(i)]),_:1})}var n=a(1387),i=a(4232);const l={key:0,id:"app"},u={class:"sidebar"},d={class:"nav-menu"},c={class:"main-content"},h={class:"header"},p={class:"header-left"},m={class:"header-right"},b={class:"user-info"},v={class:"user-name"},g={class:"content"},k={class:"dashboard-grid"},f={class:"main-area"},y={class:"sidebar-widgets"},L={class:"widget-card"},D={class:"widget-content"},C={class:"game-info"},w={class:"date"},_={class:"widget-card"},E={class:"widget-card"},x={class:"widget-content"},M={class:"modal-body"},q={class:"user-info-modal"},B={class:"user-details"},P={class:"modal-footer"},S={key:1,class:"redirect-overlay"};function A(e,t,a,o,n,A){const I=(0,s.g2)("router-link"),X=(0,s.g2)("router-view"),F=(0,s.g2)("StatisticsWidget");return o.isAuthenticated?((0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",u,[t[14]||(t[14]=(0,s.Lk)("div",{class:"logo"},[(0,s.Lk)("h2",null,"üìã CoachPro")],-1)),(0,s.Lk)("nav",d,[(0,s.bF)(I,{to:"/home",class:"nav-item","exact-active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[6]||(t[6]=[(0,s.Lk)("span",{class:"icon"},"üè†",-1),(0,s.Lk)("span",{class:"text"},"Accueil",-1)])]),_:1}),(0,s.bF)(I,{to:"/bordereaux",class:"nav-item","active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[7]||(t[7]=[(0,s.Lk)("span",{class:"icon"},"üìã",-1),(0,s.Lk)("span",{class:"text"},"Bordereaux",-1)])]),_:1}),(0,s.bF)(I,{to:"/banque",class:"nav-item","active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[8]||(t[8]=[(0,s.Lk)("span",{class:"icon"},"üè¶",-1),(0,s.Lk)("span",{class:"text"},"Banques",-1)])]),_:1}),t[13]||(t[13]=(0,s.Lk)("div",{class:"nav-section"},"Gestion",-1)),(0,s.bF)(I,{to:"/statistiques",class:"nav-item","active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[9]||(t[9]=[(0,s.Lk)("span",{class:"icon"},"üìä",-1),(0,s.Lk)("span",{class:"text"},"Statistiques",-1)])]),_:1}),(0,s.bF)(I,{to:"/departement",class:"nav-item","active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[10]||(t[10]=[(0,s.Lk)("span",{class:"icon"},"üìñ",-1),(0,s.Lk)("span",{class:"text"},"D√©partement",-1)])]),_:1}),(0,s.bF)(I,{to:"/search-by-date",class:"nav-item","active-class":"router-link-active"},{default:(0,s.k6)(()=>[...t[11]||(t[11]=[(0,s.Lk)("span",{class:"icon"},"üîç",-1),(0,s.Lk)("span",{class:"text"},"Recherche par date",-1)])]),_:1}),(0,s.Lk)("div",{class:"nav-item logout-item",onClick:t[0]||(t[0]=(...e)=>o.confirmLogout&&o.confirmLogout(...e))},[...t[12]||(t[12]=[(0,s.Lk)("span",{class:"icon"},"üö™",-1),(0,s.Lk)("span",{class:"text"},"D√©connexion",-1)])])])]),(0,s.Lk)("div",c,[(0,s.Lk)("header",h,[(0,s.Lk)("div",p,[(0,s.Lk)("h1",null,(0,i.v_)(o.currentPageTitle),1)]),(0,s.Lk)("div",m,[(0,s.Lk)("div",b,[(0,s.Lk)("span",v,(0,i.v_)(o.userEmail||"Admin"),1),t[15]||(t[15]=(0,s.Lk)("div",{class:"user-avatar"},"üë§",-1))])])]),(0,s.Lk)("main",g,[(0,s.Lk)("div",k,[(0,s.Lk)("div",f,[(0,s.bF)(X,null,{default:(0,s.k6)(({Component:e})=>[(0,s.bF)(r.eB,{name:"fade",mode:"out-in"},{default:(0,s.k6)(()=>[((0,s.uX)(),(0,s.Wv)((0,s.$y)(e)))]),_:2},1024)]),_:1})]),(0,s.Lk)("div",y,[(0,s.Lk)("div",L,[t[17]||(t[17]=(0,s.Lk)("h3",null,"üìä Prochain Rapport",-1)),(0,s.Lk)("div",D,[(0,s.Lk)("div",C,[t[16]||(t[16]=(0,s.Lk)("span",{class:"league"},"Rapport Financier",-1)),(0,s.Lk)("span",w,(0,i.v_)(o.nextReportDate),1)])])]),t[22]||(t[22]=(0,s.Fv)('<div class="widget-card" data-v-20bdbb9f><h3 data-v-20bdbb9f>üñ•Ô∏è Statut Serveur</h3><div class="widget-content" data-v-20bdbb9f><div class="status-item" data-v-20bdbb9f><span class="status-dot active" data-v-20bdbb9f></span><span data-v-20bdbb9f>API Bordereaux</span></div><div class="status-item" data-v-20bdbb9f><span class="status-dot active" data-v-20bdbb9f></span><span data-v-20bdbb9f>API Banques</span></div><div class="status-item" data-v-20bdbb9f><span class="status-dot active" data-v-20bdbb9f></span><span data-v-20bdbb9f>Base de donn√©es</span></div><div class="status-item" data-v-20bdbb9f><span class="status-dot" data-v-20bdbb9f></span><span data-v-20bdbb9f>Backup Service</span></div></div></div>',1)),(0,s.Lk)("div",_,[(0,s.bF)(F)]),(0,s.Lk)("div",E,[t[21]||(t[21]=(0,s.Lk)("h3",null,"‚ö° Actions Rapides",-1)),(0,s.Lk)("div",x,[(0,s.bF)(I,{to:"/bordereaux",class:"action-btn"},{default:(0,s.k6)(()=>[...t[18]||(t[18]=[(0,s.Lk)("span",{class:"action-icon"},"‚ûï",-1),(0,s.eW)(" Nouveau Bordereau ",-1)])]),_:1}),(0,s.bF)(I,{to:"/banque",class:"action-btn"},{default:(0,s.k6)(()=>[...t[19]||(t[19]=[(0,s.Lk)("span",{class:"action-icon"},"üè¶",-1),(0,s.eW)(" Nouvelle Banque ",-1)])]),_:1}),(0,s.Lk)("button",{class:"action-btn",onClick:t[1]||(t[1]=(...e)=>o.generateReport&&o.generateReport(...e))},[...t[20]||(t[20]=[(0,s.Lk)("span",{class:"action-icon"},"üìä",-1),(0,s.eW)(" G√©n√©rer Rapport ",-1)])])])])])])])]),o.showLogoutModal?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"modal-overlay",onClick:t[5]||(t[5]=(...e)=>o.cancelLogout&&o.cancelLogout(...e))},[(0,s.Lk)("div",{class:"modal-content",onClick:t[4]||(t[4]=(0,r.D$)(()=>{},["stop"]))},[t[26]||(t[26]=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h3",null,"üîê Confirmation de d√©connexion")],-1)),(0,s.Lk)("div",M,[t[25]||(t[25]=(0,s.Lk)("p",null,"√ätes-vous s√ªr de vouloir vous d√©connecter ?",-1)),(0,s.Lk)("div",q,[t[24]||(t[24]=(0,s.Lk)("div",{class:"user-avatar-modal"},"üë§",-1)),(0,s.Lk)("div",B,[(0,s.Lk)("strong",null,(0,i.v_)(o.userEmail||"norlandehubery@gmail.com"),1),t[23]||(t[23]=(0,s.Lk)("span",null,"Utilisateur connect√©",-1))])])]),(0,s.Lk)("div",P,[(0,s.Lk)("button",{class:"btn-cancel",onClick:t[2]||(t[2]=(...e)=>o.cancelLogout&&o.cancelLogout(...e))}," Annuler "),(0,s.Lk)("button",{class:"btn-confirm",onClick:t[3]||(t[3]=(...e)=>o.confirmLogoutAction&&o.confirmLogoutAction(...e))}," Se d√©connecter ")])])])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",S,[...t[27]||(t[27]=[(0,s.Lk)("div",{class:"redirect-content"},[(0,s.Lk)("div",{class:"spinner"}),(0,s.Lk)("p",null,"V√©rification de l'authentification..."),(0,s.Lk)("p",{class:"redirect-message"},"Redirection vers la page de connexion")],-1)])]))}a(4114);var I=a(144);const X={class:"statistics-widget"},F={class:"period-selector"},R={key:0,class:"loading"},U={key:1,class:"error"},Q={key:2,class:"chart-container"},T={ref:"chartRef",id:"myChart"};function j(e,t,a,o,n,l){return(0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",F,[t[3]||(t[3]=(0,s.Lk)("label",{for:"period"},"P√©riode : ",-1)),(0,s.bo)((0,s.Lk)("select",{id:"period","onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedPeriod=e),onChange:t[1]||(t[1]=(...e)=>o.updateStats&&o.updateStats(...e))},[...t[2]||(t[2]=[(0,s.Lk)("option",{value:"7"},"7 jours",-1),(0,s.Lk)("option",{value:"30"},"30 jours",-1),(0,s.Lk)("option",{value:"90"},"90 jours",-1)])],544),[[r.u1,o.selectedPeriod]])]),o.loading?((0,s.uX)(),(0,s.CE)("div",R,"Chargement des donn√©es...")):o.errorMessage?((0,s.uX)(),(0,s.CE)("div",U,"Erreur : "+(0,i.v_)(o.errorMessage),1)):((0,s.uX)(),(0,s.CE)("div",Q,[(0,s.Lk)("canvas",T,null,512)]))])}a(8111),a(116),a(1701),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var V=a(3861),O={name:"StatisticsWidget",emits:["data-loaded","historical-data-loaded"],setup(e,{emit:t}){const a=(0,I.KR)(null),r=(0,I.KR)(null),o=(0,I.KR)([]),n=(0,I.KR)([]),i=(0,I.KR)(""),l=(0,I.KR)(!0),u=(0,I.KR)(7),d=async e=>{try{l.value=!0,i.value="",console.log("üìä Fetching stats with period:",e);const a=`http://localhost/bordereau/backend/bordereau_api.php?stats=true&period=${e}`,r=`http://localhost/bordereau/backend/banque_api.php?stats=true&period=${e}`,u="http://localhost/bordereau/backend/bordereau_api.php",d="http://localhost/bordereau/backend/banque_api.php";console.log("üîó URLs:",{bordereauUrl:a,banqueUrl:r,bordereauHistoricalUrl:u,banqueHistoricalUrl:d});const[h,p,m,b]=await Promise.all([fetch(a),fetch(r),fetch(u),fetch(d)]);if(console.log("üì® Status des r√©ponses:",{bordereau:h.status,banque:p.status,bordereauHistorical:m.status,banqueHistorical:b.status}),!h.ok)throw new Error(`Bordereaux p√©riode: ${h.status}`);if(!p.ok)throw new Error(`Banques p√©riode: ${p.status}`);if(!m.ok)throw new Error(`Bordereaux historique: ${m.status}`);if(!b.ok)throw new Error(`Banques historique: ${b.status}`);const[v,g,k,f]=await Promise.all([h.json(),p.json(),m.json(),b.json()]);console.log("üìä Donn√©es re√ßues:",{bordereau:v,banque:g,bordereauHistorical:k,banqueHistorical:f}),o.value=Array.isArray(v)?v:[],n.value=Array.isArray(g)?g:[],t("data-loaded",{bordereauData:o.value,banqueData:n.value}),t("historical-data-loaded",{bordereauHistorical:k,banqueHistorical:f}),await(0,s.dY)(),c()}catch(a){console.error("üí• Erreur:",a),i.value=a.message,h()}finally{l.value=!1}},c=()=>{if(!a.value)return console.error("‚ùå Canvas non trouv√©!"),void setTimeout(()=>{a.value&&c()},100);r.value&&(r.value.destroy(),r.value=null);try{const e=[...new Set([...o.value.map(e=>e.day),...n.value.map(e=>e.day)])].sort();console.log("üìÖ Jours uniques:",e),console.log("üìä Donn√©es bordereau:",o.value),console.log("üìä Donn√©es banque:",n.value);const t=e.map(e=>{const t=o.value.find(t=>t.day===e);return t?parseInt(t.count):0}),s=e.map(e=>{const t=n.value.find(t=>t.day===e);return t?parseInt(t.count):0});console.log("üìà Donn√©es pour graphique:",{labels:e,bordereau:t,banque:s});const i=a.value.getContext("2d");if(!i)throw new Error("Contexte Canvas non disponible");r.value=new V.t1(i,{type:"bar",data:{labels:e,datasets:[{label:"Bordereaux",data:t,backgroundColor:"rgba(54, 162, 235, 0.8)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:2,borderRadius:4},{label:"Banques",data:s,backgroundColor:"rgba(75, 192, 192, 0.8)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:2,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:12,weight:"bold"}}},title:{display:!0,text:"√âvolution des enregistrements",font:{size:16,weight:"bold"}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Nombre d'enregistrements",font:{weight:"bold"}},grid:{color:"rgba(0, 0, 0, 0.1)"}},x:{title:{display:!0,text:"Date",font:{weight:"bold"}},grid:{color:"rgba(0, 0, 0, 0.1)"}}},animation:{duration:1e3,easing:"easeInOutQuart"}}}),console.log("‚úÖ Graphique cr√©√© avec succ√®s")}catch(e){console.error("üí• Erreur cr√©ation graphique:",e),i.value="Erreur cr√©ation graphique: "+e.message,setTimeout(()=>{h()},500)}},h=()=>{if(a.value){r.value&&(r.value.destroy(),r.value=null);try{const e=a.value.getContext("2d");if(!e)throw new Error("Contexte Canvas non disponible pour la d√©mo");r.value=new V.t1(e,{type:"bar",data:{labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],datasets:[{label:"Bordereaux (demo)",data:[12,19,3,5,2,3,7],backgroundColor:"rgba(54, 162, 235, 0.8)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:2},{label:"Banques (demo)",data:[8,15,7,12,6,9,4],backgroundColor:"rgba(75, 192, 192, 0.8)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1}}),console.log("üìä Graphique de d√©monstration cr√©√©")}catch(e){console.error("‚ùå Erreur demo chart:",e)}}else console.warn("‚ùå Canvas non disponible pour le graphique de d√©mo")},p=()=>{d(u.value)};return(0,s.sV)(()=>{console.log("üöÄ StatisticsWidget mont√©"),console.log("üìç R√©f√©rence chartRef:",a.value),setTimeout(()=>{console.log("‚è∞ Apr√®s d√©lai - chartRef:",a.value),d(u.value)},300)}),{chartRef:a,errorMessage:i,loading:l,selectedPeriod:u,updateStats:p}}},W=a(1241);const N=(0,W.A)(O,[["render",j],["__scopeId","data-v-94233c7c"]]);var Y=N,$={name:"DefaultLayout",components:{StatisticsWidget:Y},setup(){const e=(0,n.lq)(),t=(0,n.rd)(),a=(0,I.KR)(!1),r=(0,s.EW)(()=>{const e="true"===localStorage.getItem("isAuthenticated");return e}),o=(0,s.EW)(()=>localStorage.getItem("userEmail")||"norlandehubery@gmail.com"),i=(0,s.EW)(()=>{switch(e.name){case"Home":return"Tableau de Bord";case"Bordereaux":return"Gestion des Bordereaux";case"Banque":return"Gestion des Banques";case"Statistiques":return"Statistiques";case"Departement":return"Gestion des D√©partements";case"SearchByDate":return"Recherche par Date";default:return"Syst√®me de Gestion"}});(0,s.wB)(r,e=>{e||t.push("/login")}),(0,s.sV)(()=>{r.value||t.push("/login")});const l=()=>{a.value=!0},u=()=>{a.value=!1},d=()=>{console.log("üö™ D√©connexion confirm√©e..."),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userEmail"),localStorage.removeItem("userData"),a.value=!1,t.push("/login")},c=()=>{console.log("G√©n√©ration du rapport...")},h=(0,I.KR)(""),p=()=>{const e=new Date,t={year:"numeric",month:"long",day:"numeric"};h.value=e.toLocaleDateString("fr-FR",t)};return(0,s.sV)(()=>{p(),setInterval(p,36e5)}),{isAuthenticated:r,userEmail:o,currentPageTitle:i,generateReport:c,nextReportDate:h,showLogoutModal:a,confirmLogout:l,cancelLogout:u,confirmLogoutAction:d}}};const K=(0,W.A)($,[["render",A],["__scopeId","data-v-20bdbb9f"]]);var J=K;const H={id:"auth-layout"};function z(e,t,a,o,n,i){const l=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",H,[(0,s.bF)(l,null,{default:(0,s.k6)(({Component:e})=>[(0,s.bF)(r.eB,{name:"fade",mode:"out-in"},{default:(0,s.k6)(()=>[((0,s.uX)(),(0,s.Wv)((0,s.$y)(e)))]),_:2},1024)]),_:1})])}var G={name:"AuthLayout"};const Z=(0,W.A)(G,[["render",z],["__scopeId","data-v-e7e8271a"]]);var ee=Z,te={name:"App",components:{DefaultLayout:J,AuthLayout:ee},setup(){const e=(0,n.lq)(),t=(0,s.EW)(()=>{const t="auth"===e.meta.layout?"AuthLayout":"DefaultLayout";return console.log("üé® App.vue - Layout s√©lectionn√©:",t),t});return{currentLayout:t}},mounted(){console.log("üèóÔ∏è App.vue mont√©"),console.log("üìä √âtat initial auth:",localStorage.getItem("isAuthenticated"))}};const ae=(0,W.A)(te,[["render",o]]);var re=ae;const se={class:"home-page"},oe={key:0,class:"stats-grid"},ne={class:"stat-card"},ie={class:"stat-info"},le={class:"stat-card"},ue={class:"stat-info"},de={class:"stat-card"},ce={class:"stat-info"},he={key:1,class:"loading-section"},pe={key:2,class:"error-section"},me={class:"recent-activity"},be={class:"activity-list"},ve={class:"activity-icon"},ge={class:"activity-content"},ke={class:"activity-time"};function fe(e,t,a,r,o,n){return(0,s.uX)(),(0,s.CE)("div",se,[t[10]||(t[10]=(0,s.Lk)("div",{class:"welcome-section"},[(0,s.Lk)("h2",null,"Bienvenue dans CoachPro"),(0,s.Lk)("p",null,"Gestion compl√®te des bordereaux")],-1)),o.loading||o.error?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",oe,[(0,s.Lk)("div",ne,[t[2]||(t[2]=(0,s.Lk)("div",{class:"stat-icon"},"üìã",-1)),(0,s.Lk)("div",ie,[(0,s.Lk)("h3",null,(0,i.v_)(o.stats.bordereauxCount),1),t[1]||(t[1]=(0,s.Lk)("p",null,"Bordereaux Actifs",-1))])]),(0,s.Lk)("div",le,[t[4]||(t[4]=(0,s.Lk)("div",{class:"stat-icon"},"‚úÖ",-1)),(0,s.Lk)("div",ue,[(0,s.Lk)("h3",null,(0,i.v_)(o.stats.successRate)+"%",1),t[3]||(t[3]=(0,s.Lk)("p",null,"Taux de R√©ussite",-1))])]),(0,s.Lk)("div",de,[t[6]||(t[6]=(0,s.Lk)("div",{class:"stat-icon"},"‚ö°",-1)),(0,s.Lk)("div",ce,[(0,s.Lk)("h3",null,(0,i.v_)(o.stats.averageTime),1),t[5]||(t[5]=(0,s.Lk)("p",null,"Temps Moyen",-1))])])])),o.loading?((0,s.uX)(),(0,s.CE)("div",he,[...t[7]||(t[7]=[(0,s.Lk)("div",{class:"spinner"},null,-1),(0,s.Lk)("p",null,"Chargement des statistiques...",-1)])])):(0,s.Q3)("",!0),o.error?((0,s.uX)(),(0,s.CE)("div",pe,[t[8]||(t[8]=(0,s.Lk)("div",{class:"error-icon"},"‚ùå",-1)),(0,s.Lk)("p",null,(0,i.v_)(o.error),1),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.loadStats&&n.loadStats(...e)),class:"btn-retry"},"R√©essayer")])):(0,s.Q3)("",!0),(0,s.Lk)("div",me,[t[9]||(t[9]=(0,s.Lk)("h3",null,"Activit√© R√©cente",-1)),(0,s.Lk)("div",be,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.recentActivities,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"activity-item",key:t},[(0,s.Lk)("span",ve,(0,i.v_)(e.icon),1),(0,s.Lk)("div",ge,[(0,s.Lk)("p",null,(0,i.v_)(e.text),1),(0,s.Lk)("span",ke,(0,i.v_)(e.time),1)])]))),128))])])])}var ye=a(4373);const Le="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"8080"===window.location.port,De=Le?"http://localhost/bordereau/backend":"/backend";console.log("üåç Environnement: "+(Le?"D√©veloppement":"Production")),console.log(`üîó URL API: ${De}`);const Ce=ye.A.create({baseURL:De,headers:{"Content-Type":"application/json"},timeout:Le?1e4:3e4});Ce.interceptors.request.use(e=>(Le&&console.log(`[ ] Making ${e.method?.toUpperCase()} request to: ${e.url}`),e),e=>(console.error(" [x] Request error:",e),Promise.reject(e))),Ce.interceptors.response.use(e=>(Le&&console.log(" [‚úì] Response received:",e.status,e.data),e),e=>{if(console.error(" [x] Response error:",e.response?.status,e.message),e.response)switch(e.response.status){case 400:e.message="Donn√©es invalides";break;case 401:e.message="Email ou mot de passe incorrect";break;case 403:e.message="Acc√®s non autoris√©";break;case 404:e.message="Resource non trouv√©e";break;case 500:e.message="Erreur interne du serveur";break;case 502:e.message="Serveur indisponible";break;case 503:e.message="Service temporairement indisponible";break;default:e.message=`Erreur ${e.response.status}: ${e.response.statusText}`}else e.request?e.message=Le?"Impossible de se connecter au serveur. V√©rifiez que WAMP est d√©marr√©.":"Serveur temporairement indisponible. Veuillez r√©essayer.":e.message="Erreur de configuration de la requ√™te";return Promise.reject(e)});const we={async login(e,t){try{Le&&console.log("üîê Tentative de connexion pour:",e);const a=await Ce.post("/login_api.php",{email:e.trim(),password:t});return a.data.success&&a.data.user&&(localStorage.setItem("userData",JSON.stringify(a.data.user)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("userEmail",a.data.user.email)),a.data}catch(a){throw console.error("Erreur dans login:",a),a}}},_e={async getBordereaux(){try{const e=await Ce.get("/bordereau_api.php");return e.data}catch(e){throw console.error("Erreur dans getBordereaux:",e),e}},async getBordereau(e){try{const t=await Ce.get(`/bordereau_api.php?id_bordereau=${e}`);return t.data}catch(t){throw console.error("Erreur dans getBordereau:",t),t}},async createBordereau(e){try{const t=await Ce.post("/bordereau_api.php",e);return t.data}catch(t){throw console.error("Erreur dans createBordereau:",t),t}},async updateBordereau(e,t){try{const a=await Ce.put(`/bordereau_api.php?id_bordereau=${e}`,t);return a.data}catch(a){throw console.error("Erreur dans updateBordereau:",a),a}},async deleteBordereau(e){try{const t=await Ce.delete(`/bordereau_api.php?id_bordereau=${e}`);return t.data}catch(t){throw console.error("Erreur dans deleteBordereau:",t),t}},async markBordereauxAsSent(e){try{const t=await Ce.patch("/bordereau_api.php/mark-as-sent",{bordereauIds:e});return t.data}catch(t){throw console.error("Erreur dans markBordereauxAsSent:",t),t}},async markSingleBordereauAsSent(e){try{const t=await Ce.patch(`/bordereau_api.php/bordereaux/${e}/mark-as-sent`);return t.data}catch(t){throw console.error("Erreur dans markSingleBordereauAsSent:",t),t}}},Ee={async getBanques(){try{const e=await Ce.get("/banque_api.php");return e.data}catch(e){throw console.error("Erreur dans getBanques:",e),e}},async createBanque(e){try{const t=await Ce.post("/banque_api.php",e);return t.data}catch(t){throw console.error("Erreur dans createBanque:",t),t}},async updateBanque(e,t){try{const a=await Ce.put(`/banque_api.php?id_banque=${e}`,t);return a.data}catch(a){throw console.error("Erreur dans updateBanque:",a),a}},async deleteBanque(e){try{const t=await Ce.delete(`/banque_api.php?id_banque=${e}`);return t.data}catch(t){throw console.error("Erreur dans deleteBanque:",t),t}}},xe={async getDepartements(){try{const e=await Ce.get("/departement_api.php");return e.data}catch(e){throw console.error("Erreur dans getDepartements:",e),e}},async getDepartement(e){try{const t=await Ce.get(`/departement_api.php?id_departement=${e}`);return t.data}catch(t){throw console.error("Erreur dans getDepartement:",t),t}},async createDepartement(e){try{const t=await Ce.post("/departement_api.php",e);return t.data}catch(t){throw console.error("Erreur dans createDepartement:",t),t}},async updateDepartement(e,t){try{const a=await Ce.put(`/departement_api.php?id_departement=${e}`,t);return a.data}catch(a){throw console.error("Erreur dans updateDepartement:",a),a}},async deleteDepartement(e){try{const t=await Ce.delete(`/departement_api.php?id_departement=${e}`);return t.data}catch(t){throw console.error("Erreur dans deleteDepartement:",t),t}}},Me={async searchByDate(e,t){try{if(!e||!t)throw new Error("La date et le type sont requis");Le&&console.log(`[ ] Recherche par date: ${e}, type: ${t}`);const a=await Ce.get("/search_api.php",{params:{date:e,type:t}});return Le&&console.log("üìû R√©sultats recherche:",a.data),a.data}catch(a){throw console.error("‚úó Erreur dans searchByDate:",a),a}}};var qe={name:"HomeView",data(){return{loading:!0,error:null,stats:{bordereauxCount:0,successRate:0,averageTime:"0h"},recentActivities:[{icon:"‚ûï",text:"Nouveau bordereau cr√©√©",time:"Il y a 2 minutes"},{icon:"üìä",text:"Rapport mensuel g√©n√©r√©",time:"Il y a 1 heure"},{icon:"‚úÖ",text:"Bordereau #456 approuv√©",time:"Il y a 3 heures"}]}},async mounted(){await this.loadStats()},methods:{async loadStats(){try{this.loading=!0,this.error=null;const e=await _e.getBordereaux();this.stats.bordereauxCount=e.length,this.stats.successRate=92,this.stats.averageTime="2.4h"}catch(e){console.error("Erreur dans loadStats:",e),this.error=e.message||"Erreur lors du chargement des statistiques"}finally{this.loading=!1}}}};const Be=(0,W.A)(qe,[["render",fe],["__scopeId","data-v-756b74c4"]]);var Pe=Be;const Se={class:"bordereaux-page"},Ae={class:"page-header"},Ie={key:0,class:"user-info"},Xe={class:"user-email"},Fe={class:"header-actions"},Re=["disabled"],Ue=["disabled"],Qe={class:"filters-section"},Te={class:"search-box"},je=["disabled"],Ve={class:"filter-group"},Oe=["disabled"],We={class:"filter-group"},Ne=["disabled"],Ye={class:"month-nav"},$e=["disabled"],Ke={class:"month-label"},Je=["disabled"],He={class:"content-section"},ze={key:0,class:"loading"},Ge={key:1,class:"error"},Ze={key:2,class:"empty-state"},et={key:0},tt={key:1},at=["disabled"],rt={key:3,class:"table-container"},st={class:"bordereaux-table"},ot={key:0,class:"checkbox-column"},nt=["checked","disabled"],it={key:0,class:"sort-icon"},lt={key:0,class:"sort-icon"},ut={key:0,class:"sort-icon"},dt={key:0,class:"sort-icon"},ct={key:0,class:"sort-icon"},ht={key:0,class:"checkbox-cell","data-label":"S√©lection"},pt=["checked","onChange","disabled"],mt={class:"id-cell","data-label":"ID"},bt={class:"reference-cell","data-label":"R√©f√©rence"},vt={class:"matricule-cell","data-label":"Matricules"},gt={class:"objet-cell","data-label":"Description"},kt=["title"],ft={class:"status-cell","data-label":"Statut"},yt={class:"date-cell","data-label":"Date"},Lt={class:"time-text"},Dt={class:"sent-cell","data-label":"√âtat"},Ct={class:"actions-cell","data-label":"Actions"},wt=["onClick","disabled"],_t=["onClick","disabled"],Et=["onClick","disabled"],xt={key:3,class:"no-permission-text"},Mt={key:0,class:"pagination"},qt=["disabled"],Bt={class:"page-info"},Pt=["disabled"],St={class:"pagination-info"},At={key:0,class:"selection-info"},It={key:0,class:"modal-overlay"},Xt={class:"modal"},Ft={class:"modal-header"},Rt={class:"modal-body"},Ut={class:"form-group"},Qt=["disabled"],Tt={class:"form-group"},jt=["disabled"],Vt={class:"form-group"},Ot={class:"matricule-input-group"},Wt=["placeholder","disabled"],Nt=["disabled"],Yt={key:0,class:"error-text"},$t={class:"form-group"},Kt=["disabled"],Jt={class:"char-count"},Ht={class:"form-group"},zt=["disabled"],Gt={class:"form-actions"},Zt=["disabled"],ea=["disabled"],ta={key:1,class:"modal-overlay"},aa={class:"modal matricule-modal"},ra={class:"modal-header"},sa={class:"modal-body"},oa={class:"form-group"},na={class:"matricule-input-group"},ia=["disabled"],la=["disabled"],ua={key:0,class:"error-text"},da={key:0,class:"matricule-list"},ca=["onClick","disabled"],ha={class:"form-actions"},pa=["disabled"],ma={key:2,class:"modal-overlay"},ba={class:"modal delete-modal"},va={class:"modal-header"},ga={class:"modal-body"},ka={class:"delete-actions"},fa=["disabled"],ya=["disabled"];function La(e,t,a,o,n,l){const u=(0,s.g2)("notifications");return(0,s.uX)(),(0,s.CE)("div",Se,[(0,s.Lk)("div",Ae,[t[37]||(t[37]=(0,s.Lk)("h2",null,"üìã Gestion des Bordereaux",-1)),n.currentUser?((0,s.uX)(),(0,s.CE)("div",Ie,[(0,s.Lk)("span",Xe,(0,i.v_)(n.currentUser.email),1),(0,s.Lk)("span",{class:(0,i.C4)(["user-type",n.currentUser.type_utilisateur])},(0,i.v_)(n.currentUser.type_utilisateur),3)])):(0,s.Q3)("",!0),(0,s.Lk)("div",Fe,[l.canCreate?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn-primary",onClick:t[0]||(t[0]=e=>n.showAddModal=!0),disabled:n.loading||!l.canCreate},[...t[35]||(t[35]=[(0,s.Lk)("span",{class:"btn-icon"},"‚ûï",-1),(0,s.eW)(" Nouveau Bordereau ",-1)])],8,Re)):(0,s.Q3)("",!0),n.selectedBordereaux.length>0&&l.canUpdate?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn-success",onClick:t[1]||(t[1]=(...e)=>l.markAsSent&&l.markAsSent(...e)),disabled:n.loading||n.markingAsSent},[t[36]||(t[36]=(0,s.Lk)("span",{class:"btn-icon"},"‚úÖ",-1)),(0,s.eW)(" Marquer comme envoy√© ("+(0,i.v_)(n.selectedBordereaux.length)+") ",1)],8,Ue)):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Qe,[(0,s.Lk)("div",Te,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.searchQuery=e),type:"text",placeholder:"Rechercher par ID, r√©f√©rence, matricule ou objet...",class:"search-input",disabled:n.loading},null,8,je),[[r.Jo,n.searchQuery]]),t[38]||(t[38]=(0,s.Lk)("span",{class:"search-icon"},"üîç",-1))]),(0,s.Lk)("div",Ve,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.statusFilter=e),class:"filter-select",disabled:n.loading},[...t[39]||(t[39]=[(0,s.Lk)("option",{value:""},"Tous les statuts",-1),(0,s.Lk)("option",{value:"Mandatement"},"Mandatement",-1),(0,s.Lk)("option",{value:"Secours"},"Secours",-1),(0,s.Lk)("option",{value:"VISA"},"VISA",-1)])],8,Oe),[[r.u1,n.statusFilter]])]),(0,s.Lk)("div",We,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.sentFilter=e),class:"filter-select",disabled:n.loading},[...t[40]||(t[40]=[(0,s.Lk)("option",{value:""},"Tous les √©tats",-1),(0,s.Lk)("option",{value:"sent"},"Envoy√©s",-1),(0,s.Lk)("option",{value:"not_sent"},"Non envoy√©s",-1)])],8,Ne),[[r.u1,n.sentFilter]])]),(0,s.Lk)("div",Ye,[(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>l.prevMonth&&l.prevMonth(...e)),disabled:n.loading,class:"nav-btn"},"‚¨Ö Pr√©c√©dent",8,$e),(0,s.Lk)("span",Ke,(0,i.v_)(l.currentMonthYear),1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.nextMonth&&l.nextMonth(...e)),disabled:n.loading,class:"nav-btn"},"Suivant ‚û°",8,Je)])]),(0,s.Lk)("div",He,[n.loading?((0,s.uX)(),(0,s.CE)("div",ze,[...t[41]||(t[41]=[(0,s.Lk)("div",{class:"spinner"},null,-1),(0,s.Lk)("p",null,"Chargement des bordereaux...",-1)])])):n.error?((0,s.uX)(),(0,s.CE)("div",Ge,[t[42]||(t[42]=(0,s.Lk)("div",{class:"error-icon"},"‚ùå",-1)),t[43]||(t[43]=(0,s.Lk)("h3",null,"Erreur de chargement",-1)),(0,s.Lk)("p",null,(0,i.v_)(n.error),1),(0,s.Lk)("button",{class:"btn-retry",onClick:t[7]||(t[7]=(...e)=>l.loadBordereaux&&l.loadBordereaux(...e))},"R√©essayer")])):0===l.groupedBordereaux.length?((0,s.uX)(),(0,s.CE)("div",Ze,[t[44]||(t[44]=(0,s.Lk)("div",{class:"empty-icon"},"üìã",-1)),t[45]||(t[45]=(0,s.Lk)("h3",null,"Aucun bordereau trouv√©",-1)),n.searchQuery||n.statusFilter||n.sentFilter?((0,s.uX)(),(0,s.CE)("p",et,"Aucun r√©sultat pour vos crit√®res de recherche")):((0,s.uX)(),(0,s.CE)("p",tt,"Commencez par cr√©er votre premier bordereau pour "+(0,i.v_)(l.currentMonthYear),1)),l.canCreate?((0,s.uX)(),(0,s.CE)("button",{key:2,class:"btn-primary",onClick:t[8]||(t[8]=e=>n.showAddModal=!0),disabled:n.loading||!l.canCreate}," ‚ûï Cr√©er un bordereau ",8,at)):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",rt,[(0,s.Lk)("table",st,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[l.canUpdate?((0,s.uX)(),(0,s.CE)("th",ot,[(0,s.Lk)("input",{type:"checkbox",checked:l.allSelected,onChange:t[9]||(t[9]=(...e)=>l.toggleSelectAll&&l.toggleSelectAll(...e)),disabled:n.loading,class:"select-all-checkbox"},null,40,nt)])):(0,s.Q3)("",!0),(0,s.Lk)("th",{onClick:t[10]||(t[10]=e=>l.sortBy("id_bordereau")),class:"sortable"},[t[46]||(t[46]=(0,s.eW)(" ID üìä ",-1)),"id_bordereau"===n.sortField?((0,s.uX)(),(0,s.CE)("span",it,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[11]||(t[11]=e=>l.sortBy("reference")),class:"sortable"},[t[47]||(t[47]=(0,s.eW)(" R√©f√©rence üìù ",-1)),"reference"===n.sortField?((0,s.uX)(),(0,s.CE)("span",lt,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),t[51]||(t[51]=(0,s.Lk)("th",null,"Matricules",-1)),t[52]||(t[52]=(0,s.Lk)("th",null,"Description",-1)),(0,s.Lk)("th",{onClick:t[12]||(t[12]=e=>l.sortBy("statut")),class:"sortable"},[t[48]||(t[48]=(0,s.eW)(" Statut üè∑Ô∏è ",-1)),"statut"===n.sortField?((0,s.uX)(),(0,s.CE)("span",ut,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[13]||(t[13]=e=>l.sortBy("date_creation")),class:"sortable"},[t[49]||(t[49]=(0,s.eW)(" Date üìÖ ",-1)),"date_creation"===n.sortField?((0,s.uX)(),(0,s.CE)("span",dt,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[14]||(t[14]=e=>l.sortBy("est_envoye")),class:"sortable"},[t[50]||(t[50]=(0,s.eW)(" √âtat üì¨ ",-1)),"est_envoye"===n.sortField?((0,s.uX)(),(0,s.CE)("span",ct,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),t[53]||(t[53]=(0,s.Lk)("th",null,"Actions",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.paginatedBordereaux,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id_bordereau,class:(0,i.C4)({"selected-row":l.isSelected(e.id_bordereau)})},[l.canUpdate?((0,s.uX)(),(0,s.CE)("td",ht,[(0,s.Lk)("input",{type:"checkbox",checked:l.isSelected(e.id_bordereau),onChange:t=>l.toggleSelect(e.id_bordereau),disabled:n.loading,class:"row-checkbox"},null,40,pt)])):(0,s.Q3)("",!0),(0,s.Lk)("td",mt,"#"+(0,i.v_)(e.id_bordereau),1),(0,s.Lk)("td",bt,[(0,s.Lk)("strong",null,(0,i.v_)(e.reference||"(vide)"),1)]),(0,s.Lk)("td",vt,(0,i.v_)(e.matricules.join(", ")),1),(0,s.Lk)("td",gt,[(0,s.Lk)("div",{class:"objet-text",title:e.objet},(0,i.v_)(l.truncateText(e.objet,60)),9,kt)]),(0,s.Lk)("td",ft,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",e.statut.toLowerCase()])},(0,i.v_)(e.statut),3)]),(0,s.Lk)("td",yt,[(0,s.eW)((0,i.v_)(l.formatDate(e.date_creation)),1),(0,s.Lk)("div",Lt,(0,i.v_)(l.formatTime(e.date_creation)),1)]),(0,s.Lk)("td",Dt,[(0,s.Lk)("span",{class:(0,i.C4)(["sent-badge",{sent:e.est_envoye,"not-sent":!e.est_envoye}])},(0,i.v_)(e.est_envoye?"‚úÖ Envoy√©":"‚è≥ Non envoy√©"),3)]),(0,s.Lk)("td",Ct,[l.canUpdate?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn-action edit-btn",onClick:t=>l.editBordereau(e),title:"Modifier",disabled:n.loading}," ‚úèÔ∏è ",8,wt)):(0,s.Q3)("",!0),l.canDelete?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn-action delete-btn",onClick:t=>l.confirmDelete(e),title:"Supprimer",disabled:n.loading}," üóëÔ∏è ",8,_t)):(0,s.Q3)("",!0),!e.est_envoye&&l.canUpdate?((0,s.uX)(),(0,s.CE)("button",{key:2,class:"btn-action send-btn",onClick:t=>l.markSingleAsSent(e.id_bordereau),title:"Marquer comme envoy√©",disabled:n.loading||n.markingAsSent}," üì§ ",8,Et)):(0,s.Q3)("",!0),l.canUpdate?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",xt," Lecture seule "))])],2))),128))])]),l.groupedBordereaux.length>n.itemsPerPage?((0,s.uX)(),(0,s.CE)("div",Mt,[(0,s.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>l.prevPage&&l.prevPage(...e)),disabled:1===n.currentPage||n.loading,class:"pagination-btn"},"‚Üê Pr√©c√©dent",8,qt),(0,s.Lk)("span",Bt,"Page "+(0,i.v_)(n.currentPage)+" sur "+(0,i.v_)(l.totalPages),1),(0,s.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>l.nextPage&&l.nextPage(...e)),disabled:n.currentPage===l.totalPages||n.loading,class:"pagination-btn"},"Suivant ‚Üí",8,Pt)])):(0,s.Q3)("",!0),(0,s.Lk)("div",St,[(0,s.eW)(" Affichage de "+(0,i.v_)(l.startIndex+1)+" √† "+(0,i.v_)(l.endIndex)+" sur "+(0,i.v_)(l.groupedBordereaux.length)+" bordereaux ",1),n.selectedBordereaux.length>0?((0,s.uX)(),(0,s.CE)("span",At," ‚Ä¢ "+(0,i.v_)(n.selectedBordereaux.length)+" bordereau(x) s√©lectionn√©(s) ",1)):(0,s.Q3)("",!0)])]))]),n.showAddModal?((0,s.uX)(),(0,s.CE)("div",It,[(0,s.Lk)("div",Xt,[(0,s.Lk)("div",Ft,[(0,s.Lk)("h3",null,(0,i.v_)(n.isEditing?"Modifier":"Ajouter")+" un bordereau",1),(0,s.Lk)("button",{class:"modal-close",onClick:t[17]||(t[17]=(...e)=>l.closeModal&&l.closeModal(...e))},"√ó")]),(0,s.Lk)("div",Rt,[(0,s.Lk)("form",{onSubmit:t[26]||(t[26]=(0,r.D$)((...e)=>l.saveBordereau&&l.saveBordereau(...e),["prevent"]))},[(0,s.Lk)("div",Ut,[t[54]||(t[54]=(0,s.Lk)("label",null,"ID Bordereau *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>n.formData.id_bordereau=e),type:"number",class:"form-input",required:"",disabled:n.isEditing||n.saving,min:"1",placeholder:"Entrez un ID unique"},null,8,Qt),[[r.Jo,n.formData.id_bordereau,void 0,{number:!0}]])]),(0,s.Lk)("div",Tt,[t[55]||(t[55]=(0,s.Lk)("label",null,"R√©f√©rence",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[19]||(t[19]=e=>n.formData.reference=e),type:"text",placeholder:"Ex: 206/MEC (facultatif)",class:"form-input",disabled:n.saving,maxlength:"50"},null,8,jt),[[r.Jo,n.formData.reference]])]),(0,s.Lk)("div",Vt,[t[56]||(t[56]=(0,s.Lk)("label",null,"Matricule(s) * (6 caract√®res alphanum√©riques)",-1)),(0,s.Lk)("div",Ot,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[20]||(t[20]=e=>n.formData.matriculeInput=e),type:"text",placeholder:n.formData.matricules.length>0?`${n.formData.matricules.length} matricule(s) ajout√©(s)`:"Ex: AB1234",class:"form-input",disabled:n.saving,onInput:t[21]||(t[21]=(...e)=>l.validateSingleMatricule&&l.validateSingleMatricule(...e))},null,40,Wt),[[r.Jo,n.formData.matriculeInput]]),(0,s.Lk)("button",{type:"button",class:"btn-add-multiple",onClick:t[22]||(t[22]=e=>n.showMatriculeModal=!0),disabled:n.saving,title:"Ajouter plusieurs matricules"}," ‚ûï Plusieurs ",8,Nt)]),n.matriculeError?((0,s.uX)(),(0,s.CE)("small",Yt,(0,i.v_)(n.matriculeError),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",$t,[t[57]||(t[57]=(0,s.Lk)("label",null,"Description * (max 500 caract√®res)",-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[23]||(t[23]=e=>n.formData.objet=e),required:"",placeholder:"Description du bordereau...",rows:"3",class:"form-textarea",disabled:n.saving,maxlength:"500"},null,8,Kt),[[r.Jo,n.formData.objet]]),(0,s.Lk)("small",Jt,(0,i.v_)(n.formData.objet.length)+"/500",1)]),(0,s.Lk)("div",Ht,[t[59]||(t[59]=(0,s.Lk)("label",null,"Statut *",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[24]||(t[24]=e=>n.formData.statut=e),required:"",class:"form-select",disabled:n.saving},[...t[58]||(t[58]=[(0,s.Lk)("option",{value:"",disabled:""},"S√©lectionner un statut",-1),(0,s.Lk)("option",{value:"Mandatement"},"Mandatement",-1),(0,s.Lk)("option",{value:"Secours"},"Secours",-1),(0,s.Lk)("option",{value:"VISA"},"VISA",-1)])],8,zt),[[r.u1,n.formData.statut]])]),(0,s.Lk)("div",Gt,[(0,s.Lk)("button",{type:"button",onClick:t[25]||(t[25]=(...e)=>l.closeModal&&l.closeModal(...e)),class:"btn-cancel",disabled:n.saving},"Annuler",8,Zt),(0,s.Lk)("button",{type:"submit",class:"btn-submit",disabled:n.saving||0===n.formData.matricules.length},(0,i.v_)(n.saving?"Enregistrement...":n.isEditing?"Modifier":"Cr√©er"),9,ea)])],32)])])])):(0,s.Q3)("",!0),n.showMatriculeModal?((0,s.uX)(),(0,s.CE)("div",ta,[(0,s.Lk)("div",aa,[(0,s.Lk)("div",ra,[t[60]||(t[60]=(0,s.Lk)("h3",null,"G√©rer les matricules",-1)),(0,s.Lk)("button",{class:"modal-close",onClick:t[27]||(t[27]=(...e)=>l.closeMatriculeModal&&l.closeMatriculeModal(...e))},"√ó")]),(0,s.Lk)("div",sa,[(0,s.Lk)("div",oa,[t[61]||(t[61]=(0,s.Lk)("label",null,"Ajouter un matricule (6 caract√®res alphanum√©riques)",-1)),(0,s.Lk)("div",na,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[28]||(t[28]=e=>n.newMatricule=e),type:"text",placeholder:"Ex: AB1234",class:"form-input",onInput:t[29]||(t[29]=(...e)=>l.validateNewMatricule&&l.validateNewMatricule(...e)),disabled:n.saving},null,40,ia),[[r.Jo,n.newMatricule]]),(0,s.Lk)("button",{type:"button",class:"btn-add-matricule",onClick:t[30]||(t[30]=(...e)=>l.addMatricule&&l.addMatricule(...e)),disabled:!n.isValidNewMatricule||n.saving}," Ajouter ",8,la)]),n.newMatriculeError?((0,s.uX)(),(0,s.CE)("small",ua,(0,i.v_)(n.newMatriculeError),1)):(0,s.Q3)("",!0)]),n.formData.matricules.length>0?((0,s.uX)(),(0,s.CE)("div",da,[(0,s.Lk)("h4",null,"Matricules ajout√©s ("+(0,i.v_)(n.formData.matricules.length)+")",1),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.formData.matricules,(e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.eW)((0,i.v_)(e)+" ",1),(0,s.Lk)("button",{class:"btn-remove-matricule",onClick:e=>l.removeMatricule(t),disabled:n.saving,title:"Supprimer ce matricule"}," üóëÔ∏è ",8,ca)]))),128))])])):(0,s.Q3)("",!0),(0,s.Lk)("div",ha,[(0,s.Lk)("button",{type:"button",onClick:t[31]||(t[31]=(...e)=>l.closeMatriculeModal&&l.closeMatriculeModal(...e)),class:"btn-cancel",disabled:n.saving},"Fermer",8,pa)])])])])):(0,s.Q3)("",!0),n.showDeleteModal?((0,s.uX)(),(0,s.CE)("div",ma,[(0,s.Lk)("div",ba,[(0,s.Lk)("div",va,[t[62]||(t[62]=(0,s.Lk)("h3",null,"Confirmer la suppression",-1)),(0,s.Lk)("button",{class:"modal-close",onClick:t[32]||(t[32]=e=>n.showDeleteModal=!1)},"√ó")]),(0,s.Lk)("div",ga,[(0,s.Lk)("p",null,[t[63]||(t[63]=(0,s.eW)("√ätes-vous s√ªr de vouloir supprimer le bordereau ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.bordereauToDelete?.reference||"(vide)"),1),t[64]||(t[64]=(0,s.eW)(" (ID: ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.bordereauToDelete?.id_bordereau),1),t[65]||(t[65]=(0,s.eW)(") avec les matricules ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.bordereauToDelete?.matricules.join(", ")),1),t[66]||(t[66]=(0,s.eW)(" ?",-1))]),t[67]||(t[67]=(0,s.Lk)("p",{class:"warning-text"},"‚ö†Ô∏è Cette action est irr√©versible !",-1)),(0,s.Lk)("div",ka,[(0,s.Lk)("button",{onClick:t[33]||(t[33]=e=>n.showDeleteModal=!1),class:"btn-cancel",disabled:n.deleting},"Annuler",8,fa),(0,s.Lk)("button",{onClick:t[34]||(t[34]=(...e)=>l.deleteBordereau&&l.deleteBordereau(...e)),class:"btn-delete",disabled:n.deleting},(0,i.v_)(n.deleting?"Suppression...":"Supprimer"),9,ya)])])])])):(0,s.Q3)("",!0),(0,s.bF)(u,{position:"top right"})])}a(1148),a(2489),a(7588),a(3579);var Da=a(8875);const Ca={getCurrentUser(){const e=localStorage.getItem("userData");return e?JSON.parse(e):null},isAuthenticated(){return"true"===localStorage.getItem("isAuthenticated")},isAdmin(){const e=this.getCurrentUser();return e&&"admin"===e.type_utilisateur},isRestrictedUser(){const e=this.getCurrentUser();return e&&"ornellaclaudia0@gmail.com"===e.email},canCreate(){return this.isAdmin()},canUpdate(){return this.isAdmin()},canDelete(){return this.isAdmin()},logout(){localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),localStorage.removeItem("userEmail"),localStorage.removeItem("token")},setUserData(e){localStorage.setItem("userData",JSON.stringify(e)),localStorage.setItem("isAuthenticated","true")}};var wa={name:"BordereauxView",setup(){const{notify:e}=(0,Da.hN)();return{notify:e}},data(){return{bordereaux:[],loading:!0,error:null,searchQuery:"",statusFilter:"",sentFilter:"",sortField:"id_bordereau",sortOrder:"desc",currentPage:1,itemsPerPage:10,showAddModal:!1,showDeleteModal:!1,showMatriculeModal:!1,isEditing:!1,saving:!1,deleting:!1,formData:{id_bordereau:null,reference:"",matriculeInput:"",matricules:[],objet:"",statut:""},bordereauToDelete:null,newMatricule:"",newMatriculeError:"",matriculeError:"",isValidNewMatricule:!1,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),interval:null,selectedBordereaux:[],markingAsSent:!1,currentUser:null}},computed:{groupedBordereaux(){const e={};this.bordereaux.forEach(t=>{e[t.id_bordereau]||(e[t.id_bordereau]={id_bordereau:t.id_bordereau,reference:t.reference,matricules:[],objet:t.objet,statut:t.statut,date_creation:t.date_creation,est_envoye:t.est_envoye||!1}),e[t.id_bordereau].matricules.push(t.matricule)});let t=Object.values(e);if(t=t.filter(e=>{const t=new Date(e.date_creation);return t.getMonth()+1===this.currentMonth&&t.getFullYear()===this.currentYear}),this.searchQuery){const e=this.searchQuery.toLowerCase();t=t.filter(t=>t.id_bordereau.toString().toLowerCase().includes(e)||t.reference.toLowerCase().includes(e)||t.matricules.some(t=>t.toLowerCase().includes(e))||t.objet&&t.objet.toLowerCase().includes(e))}return this.statusFilter&&(t=t.filter(e=>e.statut===this.statusFilter)),this.sentFilter&&("sent"===this.sentFilter?t=t.filter(e=>e.est_envoye):"not_sent"===this.sentFilter&&(t=t.filter(e=>!e.est_envoye))),t.sort((e,t)=>{let a="asc"===this.sortOrder?1:-1;return"date_creation"===this.sortField?(new Date(e[this.sortField])-new Date(t[this.sortField]))*a:"est_envoye"===this.sortField?(e[this.sortField]-t[this.sortField])*a:e[this.sortField]<t[this.sortField]?-1*a:e[this.sortField]>t[this.sortField]?1*a:0})},paginatedBordereaux(){const e=(this.currentPage-1)*this.itemsPerPage;return this.groupedBordereaux.slice(e,e+this.itemsPerPage)},totalPages(){return Math.ceil(this.groupedBordereaux.length/this.itemsPerPage)},startIndex(){return(this.currentPage-1)*this.itemsPerPage},endIndex(){return Math.min(this.startIndex+this.itemsPerPage,this.groupedBordereaux.length)},currentMonthYear(){const e=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];return`${e[this.currentMonth-1]} ${this.currentYear}`},allSelected(){return this.paginatedBordereaux.length>0&&this.paginatedBordereaux.every(e=>this.isSelected(e.id_bordereau))},canCreate(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur},canUpdate(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur},canDelete(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur}},watch:{searchQuery(){this.currentPage=1},statusFilter(){this.currentPage=1},sentFilter(){this.currentPage=1},"formData.objet"(e){e.length>500&&(this.formData.objet=e.substring(0,500),this.notify({title:"Erreur",text:"La description d√©passe la limite de 500 caract√®res",type:"error"}))},currentMonth(e,t){e!==t&&(this.currentPage=1,this.selectedBordereaux=[])},currentYear(e,t){e!==t&&(this.currentPage=1,this.selectedBordereaux=[])}},async mounted(){console.log("BordereauxView mounted"),this.currentUser=Ca.getCurrentUser(),this.currentUser?(console.log("Utilisateur connect√©:",this.currentUser),this.updateCurrentDate(),await this.loadBordereaux(),this.interval=setInterval(this.updateCurrentDate,6e4)):this.notify({title:"Erreur",text:"Utilisateur non connect√©",type:"error"})},beforeUnmount(){this.interval&&clearInterval(this.interval)},methods:{async loadBordereaux(){console.log("Loading bordereaux...");try{this.loading=!0,this.error=null,this.bordereaux=await _e.getBordereaux(),console.log("Bordereaux charg√©s:",this.bordereaux)}catch(e){console.error("Erreur d√©taill√©e:",e),this.error=e.response?.data?.error||e.message||"Erreur de connexion √† l'API",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.loading=!1}},isSelected(e){return this.selectedBordereaux.includes(e)},toggleSelect(e){const t=this.selectedBordereaux.indexOf(e);t>-1?this.selectedBordereaux.splice(t,1):this.selectedBordereaux.push(e)},toggleSelectAll(){this.allSelected?this.paginatedBordereaux.forEach(e=>{const t=this.selectedBordereaux.indexOf(e.id_bordereau);t>-1&&this.selectedBordereaux.splice(t,1)}):this.paginatedBordereaux.forEach(e=>{this.isSelected(e.id_bordereau)||this.selectedBordereaux.push(e.id_bordereau)})},async markAsSent(){if(0!==this.selectedBordereaux.length)try{this.markingAsSent=!0,await _e.markBordereauxAsSent(this.selectedBordereaux),await this.loadBordereaux(),this.notify({title:"Succ√®s",text:`${this.selectedBordereaux.length} bordereau(x) marqu√©(s) comme envoy√©(s)`,type:"success"}),this.selectedBordereaux=[]}catch(e){console.error("Erreur lors du marquage:",e),this.notify({title:"Erreur",text:e.response?.data?.error||"Erreur lors du marquage des bordereaux",type:"error"})}finally{this.markingAsSent=!1}},async markSingleAsSent(e){try{this.markingAsSent=!0,await _e.markSingleBordereauAsSent(e),await this.loadBordereaux(),this.notify({title:"Succ√®s",text:"Bordereau marqu√© comme envoy√©",type:"success"})}catch(t){console.error("Erreur lors du marquage:",t),this.notify({title:"Erreur",text:t.response?.data?.error||"Erreur lors du marquage du bordereau",type:"error"})}finally{this.markingAsSent=!1}},sortBy(e){this.sortField===e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortField=e,this.sortOrder="asc")},editBordereau(e){this.canUpdate?(this.isEditing=!0,this.formData={id_bordereau:e.id_bordereau,reference:e.reference,matriculeInput:"",matricules:[...e.matricules],objet:e.objet,statut:e.statut},this.showAddModal=!0):this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour modifier les bordereaux",type:"warning"})},confirmDelete(e){this.canDelete?(this.bordereauToDelete=e,this.showDeleteModal=!0):this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour supprimer les bordereaux",type:"warning"})},async deleteBordereau(){try{this.deleting=!0,console.log("Requ√™te DELETE:",this.bordereauToDelete.id_bordereau),await _e.deleteBordereau(this.bordereauToDelete.id_bordereau),await this.loadBordereaux(),this.showDeleteModal=!1,this.notify({title:"Succ√®s",text:"Bordereau supprim√© avec succ√®s",type:"success"})}catch(e){console.error("Erreur suppression:",e.response?.data||e.message),this.error=e.response?.data?.error||e.message||"Erreur lors de la suppression",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.deleting=!1}},validateSingleMatricule(){if(this.matriculeError="",this.formData.matriculeInput){const e=this.formData.matriculeInput.trim();/^[a-zA-Z0-9]{6}$/.test(e)?this.formData.matricules.includes(e)||(this.formData.matricules=[e]):this.matriculeError="Le matricule doit contenir exactement 6 caract√®res alphanum√©riques"}else this.formData.matricules=[]},validateNewMatricule(){this.newMatriculeError="",this.isValidNewMatricule=!1;const e=this.newMatricule.trim();e&&(/^[a-zA-Z0-9]{6}$/.test(e)?this.formData.matricules.includes(e)?this.newMatriculeError="Ce matricule est d√©j√† ajout√©":this.isValidNewMatricule=!0:this.newMatriculeError="Le matricule doit contenir exactement 6 caract√®res alphanum√©riques")},addMatricule(){this.isValidNewMatricule&&(this.formData.matricules.push(this.newMatricule.trim()),this.newMatricule="",this.validateNewMatricule())},removeMatricule(e){this.formData.matricules.splice(e,1)},async saveBordereau(){if(!this.isEditing||this.canUpdate)if(this.isEditing||this.canCreate)try{if(this.saving=!0,!this.formData.id_bordereau||this.formData.id_bordereau<1)throw new Error("L'ID bordereau doit √™tre un nombre positif");if(0===this.formData.matricules.length)throw new Error("Au moins un matricule est requis");if(this.formData.reference.length>50)throw new Error("La r√©f√©rence d√©passe la limite de 50 caract√®res");if(!this.formData.objet||!this.formData.statut)throw new Error("Les champs objet et statut sont requis");const e={id_bordereau:this.formData.id_bordereau,matricules:this.formData.matricules,reference:this.formData.reference,objet:this.formData.objet,statut:this.formData.statut,isEditing:this.isEditing};if(console.log("Donn√©es envoy√©es √† l'API:",e),this.isEditing)console.log("Requ√™te PUT:",this.formData.id_bordereau),await _e.updateBordereau(this.formData.id_bordereau,e),this.notify({title:"Succ√®s",text:"Bordereau modifi√© avec succ√®s",type:"success"});else{console.log("Requ√™te POST:",e);const t=await _e.createBordereau(e);this.notify({title:"Succ√®s",text:`Bordereau cr√©√© avec succ√®s (ID: ${t.id_bordereau})`,type:"success"})}await this.loadBordereaux(),this.closeModal()}catch(e){console.error("Erreur sauvegarde:",e.response?.data||e.message),this.error=e.response?.data?.error||e.message||"Erreur lors de la sauvegarde",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.saving=!1}else this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour cr√©er des bordereaux",type:"warning"});else this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour modifier les bordereaux",type:"warning"})},closeModal(){this.showAddModal=!1,this.showMatriculeModal=!1,this.isEditing=!1,this.formData={id_bordereau:null,reference:"",matriculeInput:"",matricules:[],objet:"",statut:""},this.newMatricule="",this.newMatriculeError="",this.matriculeError="",this.isValidNewMatricule=!1,this.error=null},closeMatriculeModal(){this.showMatriculeModal=!1,this.newMatricule="",this.newMatriculeError="",this.isValidNewMatricule=!1},nextPage(){this.currentPage<this.totalPages&&!this.loading&&this.currentPage++},prevPage(){this.currentPage>1&&!this.loading&&this.currentPage--},formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit"})},formatTime(e){return new Date(e).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})},truncateText(e,t){return e?e.length>t?e.substring(0,t)+"...":e:""},updateCurrentDate(){const e=new Date,t=e.getMonth()+1,a=e.getFullYear();this.currentMonth===t&&this.currentYear===a||(this.currentMonth=t,this.currentYear=a)},prevMonth(){1===this.currentMonth?(this.currentMonth=12,this.currentYear--):this.currentMonth--,this.currentPage=1,this.selectedBordereaux=[]},nextMonth(){12===this.currentMonth?(this.currentMonth=1,this.currentYear++):this.currentMonth++,this.currentPage=1,this.selectedBordereaux=[]}}};const _a=(0,W.A)(wa,[["render",La],["__scopeId","data-v-602161ca"]]);var Ea=_a;const xa={class:"banque-page"},Ma={class:"page-header"},qa={key:0,class:"user-info"},Ba={class:"user-email"},Pa=["disabled"],Sa={class:"filters-section"},Aa={class:"search-box"},Ia=["disabled"],Xa={class:"month-nav"},Fa=["disabled"],Ra={class:"month-label"},Ua=["disabled"],Qa={class:"content-section"},Ta={key:0,class:"loading"},ja={key:1,class:"error"},Va={key:2,class:"empty-state"},Oa={key:0},Wa={key:1},Na=["disabled"],Ya={key:3,class:"table-container"},$a={class:"banques-table"},Ka={key:0,class:"sort-icon"},Ja={key:0,class:"sort-icon"},Ha={class:"id-cell"},za={class:"nom-cell"},Ga={class:"section-cell"},Za={class:"date-cell"},er={class:"actions-cell"},tr=["onClick","disabled"],ar=["onClick","disabled"],rr={key:2,class:"no-permission-text"},sr={key:0,class:"pagination"},or=["disabled"],nr={class:"page-info"},ir=["disabled"],lr={class:"pagination-info"},ur={key:0,class:"modal-overlay"},dr={class:"modal"},cr={class:"modal-header"},hr={class:"modal-body"},pr={class:"form-group"},mr=["disabled"],br={key:0,class:"error-text"},vr={class:"form-group"},gr=["disabled"],kr={class:"form-group"},fr=["disabled"],yr={class:"form-actions"},Lr=["disabled"],Dr=["disabled"],Cr={key:1,class:"modal-overlay"},wr={class:"modal delete-modal"},_r={class:"modal-header"},Er={class:"modal-body"},xr={class:"delete-actions"},Mr=["disabled"],qr=["disabled"];function Br(e,t,a,o,n,l){const u=(0,s.g2)("notifications");return(0,s.uX)(),(0,s.CE)("div",xa,[(0,s.Lk)("div",Ma,[t[20]||(t[20]=(0,s.Lk)("h2",null,"üè¶ Gestion des Banques",-1)),n.currentUser?((0,s.uX)(),(0,s.CE)("div",qa,[(0,s.Lk)("span",Ba,(0,i.v_)(n.currentUser.email),1),(0,s.Lk)("span",{class:(0,i.C4)(["user-type",n.currentUser.type_utilisateur])},(0,i.v_)(n.currentUser.type_utilisateur),3)])):(0,s.Q3)("",!0),l.canCreate?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn-primary",onClick:t[0]||(t[0]=e=>n.showAddModal=!0),disabled:n.loading||!l.canCreate},[...t[19]||(t[19]=[(0,s.Lk)("span",{class:"btn-icon"},"‚ûï",-1),(0,s.eW)(" Nouvelle Banque ",-1)])],8,Pa)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Sa,[(0,s.Lk)("div",Aa,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.searchQuery=e),type:"text",placeholder:"Rechercher par ID ou nom...",class:"search-input",disabled:n.loading},null,8,Ia),[[r.Jo,n.searchQuery]]),t[21]||(t[21]=(0,s.Lk)("span",{class:"search-icon"},"üîç",-1))]),(0,s.Lk)("div",Xa,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.prevMonth&&l.prevMonth(...e)),disabled:n.loading,class:"nav-btn"},"‚¨Ö Pr√©c√©dent",8,Fa),(0,s.Lk)("span",Ra,(0,i.v_)(l.currentMonthYear),1),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.nextMonth&&l.nextMonth(...e)),disabled:n.loading,class:"nav-btn"},"Suivant ‚û°",8,Ua)])]),(0,s.Lk)("div",Qa,[n.loading?((0,s.uX)(),(0,s.CE)("div",Ta,[...t[22]||(t[22]=[(0,s.Lk)("div",{class:"spinner"},null,-1),(0,s.Lk)("p",null,"Chargement des banques...",-1)])])):n.error?((0,s.uX)(),(0,s.CE)("div",ja,[t[23]||(t[23]=(0,s.Lk)("div",{class:"error-icon"},"‚ùå",-1)),t[24]||(t[24]=(0,s.Lk)("h3",null,"Erreur de chargement",-1)),(0,s.Lk)("p",null,(0,i.v_)(n.error),1),(0,s.Lk)("button",{class:"btn-retry",onClick:t[4]||(t[4]=(...e)=>l.loadBanques&&l.loadBanques(...e))},"R√©essayer")])):0===l.filteredBanques.length?((0,s.uX)(),(0,s.CE)("div",Va,[t[25]||(t[25]=(0,s.Lk)("div",{class:"empty-icon"},"üè¶",-1)),t[26]||(t[26]=(0,s.Lk)("h3",null,"Aucune banque trouv√©e",-1)),n.searchQuery?((0,s.uX)(),(0,s.CE)("p",Oa,"Aucun r√©sultat pour vos crit√®res de recherche")):((0,s.uX)(),(0,s.CE)("p",Wa,"Commencez par ajouter une banque pour "+(0,i.v_)(l.currentMonthYear),1)),l.canCreate?((0,s.uX)(),(0,s.CE)("button",{key:2,class:"btn-primary",onClick:t[5]||(t[5]=e=>n.showAddModal=!0),disabled:n.loading||!l.canCreate}," ‚ûï Ajouter une banque ",8,Na)):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",Ya,[(0,s.Lk)("table",$a,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{onClick:t[6]||(t[6]=e=>l.sortBy("id_banque")),class:"sortable"},[t[27]||(t[27]=(0,s.eW)(" ID üìä ",-1)),"id_banque"===n.sortField?((0,s.uX)(),(0,s.CE)("span",Ka,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[7]||(t[7]=e=>l.sortBy("nom")),class:"sortable"},[t[28]||(t[28]=(0,s.eW)(" Nom üìù ",-1)),"nom"===n.sortField?((0,s.uX)(),(0,s.CE)("span",Ja,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),t[29]||(t[29]=(0,s.Lk)("th",null,"Section",-1)),t[30]||(t[30]=(0,s.Lk)("th",null,"Date üìÖ",-1)),t[31]||(t[31]=(0,s.Lk)("th",null,"Actions",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.paginatedBanques,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id_banque},[(0,s.Lk)("td",Ha,(0,i.v_)(e.id_banque),1),(0,s.Lk)("td",za,[(0,s.Lk)("strong",null,(0,i.v_)(e.nom),1)]),(0,s.Lk)("td",Ga,(0,i.v_)(e.section),1),(0,s.Lk)("td",Za,(0,i.v_)(l.formatDate(e.date_creation)),1),(0,s.Lk)("td",er,[l.canUpdate?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn-action edit-btn",onClick:t=>l.editBanque(e),title:"Modifier",disabled:n.loading}," ‚úèÔ∏è ",8,tr)):(0,s.Q3)("",!0),l.canDelete?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn-action delete-btn",onClick:t=>l.confirmDelete(e),title:"Supprimer",disabled:n.loading}," üóëÔ∏è ",8,ar)):(0,s.Q3)("",!0),l.canUpdate?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",rr," Lecture seule "))])]))),128))])]),l.filteredBanques.length>n.itemsPerPage?((0,s.uX)(),(0,s.CE)("div",sr,[(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>l.prevPage&&l.prevPage(...e)),disabled:1===n.currentPage||n.loading,class:"pagination-btn"},"‚Üê Pr√©c√©dent",8,or),(0,s.Lk)("span",nr,"Page "+(0,i.v_)(n.currentPage)+" sur "+(0,i.v_)(l.totalPages),1),(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>l.nextPage&&l.nextPage(...e)),disabled:n.currentPage===l.totalPages||n.loading,class:"pagination-btn"},"Suivant ‚Üí",8,ir)])):(0,s.Q3)("",!0),(0,s.Lk)("div",lr,"Affichage de "+(0,i.v_)(l.startIndex+1)+" √† "+(0,i.v_)(l.endIndex)+" sur "+(0,i.v_)(l.filteredBanques.length)+" banques",1)]))]),n.showAddModal?((0,s.uX)(),(0,s.CE)("div",ur,[(0,s.Lk)("div",dr,[(0,s.Lk)("div",cr,[(0,s.Lk)("h3",null,(0,i.v_)(n.isEditing?"Modifier":"Ajouter")+" une banque",1),(0,s.Lk)("button",{class:"modal-close",onClick:t[10]||(t[10]=(...e)=>l.closeModal&&l.closeModal(...e))},"√ó")]),(0,s.Lk)("div",hr,[(0,s.Lk)("form",{onSubmit:t[15]||(t[15]=(0,r.D$)((...e)=>l.saveBanque&&l.saveBanque(...e),["prevent"]))},[(0,s.Lk)("div",pr,[t[32]||(t[32]=(0,s.Lk)("label",null,"ID Banque *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>n.formData.id_banque=e),type:"number",class:"form-input",required:"",disabled:n.isEditing||n.saving,min:"1",placeholder:"Entrez un ID unique"},null,8,mr),[[r.Jo,n.formData.id_banque,void 0,{number:!0}]]),n.idError?((0,s.uX)(),(0,s.CE)("small",br,(0,i.v_)(n.idError),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",vr,[t[33]||(t[33]=(0,s.Lk)("label",null,"Nom *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>n.formData.nom=e),type:"text",placeholder:"Ex: Rakoto",class:"form-input",required:"",disabled:n.saving,maxlength:"100"},null,8,gr),[[r.Jo,n.formData.nom]])]),(0,s.Lk)("div",kr,[t[35]||(t[35]=(0,s.Lk)("label",null,"Section *",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>n.formData.section=e),required:"",class:"form-select",disabled:n.saving},[...t[34]||(t[34]=[(0,s.Lk)("option",{value:"",disabled:""},"S√©lectionner une section",-1),(0,s.Lk)("option",{value:"PVO005"},"PVO005",-1),(0,s.Lk)("option",{value:"PSC005"},"PSC005",-1)])],8,fr),[[r.u1,n.formData.section]])]),(0,s.Lk)("div",yr,[(0,s.Lk)("button",{type:"button",onClick:t[14]||(t[14]=(...e)=>l.closeModal&&l.closeModal(...e)),class:"btn-cancel",disabled:n.saving},"Annuler",8,Lr),(0,s.Lk)("button",{type:"submit",class:"btn-submit",disabled:n.saving},(0,i.v_)(n.saving?"Enregistrement...":n.isEditing?"Modifier":"Cr√©er"),9,Dr)])],32)])])])):(0,s.Q3)("",!0),n.showDeleteModal?((0,s.uX)(),(0,s.CE)("div",Cr,[(0,s.Lk)("div",wr,[(0,s.Lk)("div",_r,[t[36]||(t[36]=(0,s.Lk)("h3",null,"Confirmer la suppression",-1)),(0,s.Lk)("button",{class:"modal-close",onClick:t[16]||(t[16]=e=>n.showDeleteModal=!1)},"√ó")]),(0,s.Lk)("div",Er,[(0,s.Lk)("p",null,[t[37]||(t[37]=(0,s.eW)("√ätes-vous s√ªr de vouloir supprimer la banque ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.banqueToDelete?.nom),1),t[38]||(t[38]=(0,s.eW)(" (ID: ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.banqueToDelete?.id_banque),1),t[39]||(t[39]=(0,s.eW)(") ?",-1))]),t[40]||(t[40]=(0,s.Lk)("p",{class:"warning-text"},"‚ö†Ô∏è Cette action est irr√©versible !",-1)),(0,s.Lk)("div",xr,[(0,s.Lk)("button",{onClick:t[17]||(t[17]=e=>n.showDeleteModal=!1),class:"btn-cancel",disabled:n.deleting},"Annuler",8,Mr),(0,s.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>l.deleteBanque&&l.deleteBanque(...e)),class:"btn-delete",disabled:n.deleting},(0,i.v_)(n.deleting?"Suppression...":"Supprimer"),9,qr)])])])])):(0,s.Q3)("",!0),(0,s.bF)(u,{position:"top right"})])}var Pr={name:"BanqueView",setup(){const{notify:e}=(0,Da.hN)();return{notify:e}},data(){return{banques:[],loading:!0,error:null,searchQuery:"",sortField:"id_banque",sortOrder:"asc",currentPage:1,itemsPerPage:10,showAddModal:!1,showDeleteModal:!1,isEditing:!1,saving:!1,deleting:!1,formData:{id_banque:null,nom:"",section:""},banqueToDelete:null,idError:"",currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),interval:null,currentUser:null}},computed:{filteredBanques(){let e=[...this.banques];if(e=e.filter(e=>{const t=new Date(e.date_creation);return t.getMonth()+1===this.currentMonth&&t.getFullYear()===this.currentYear}),this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter(e=>e.id_banque.toString().includes(t)||e.nom.toLowerCase().includes(t))}return e.sort((e,t)=>{let a="asc"===this.sortOrder?1:-1;return e[this.sortField]<t[this.sortField]?-1*a:e[this.sortField]>t[this.sortField]?1*a:0})},paginatedBanques(){const e=(this.currentPage-1)*this.itemsPerPage;return this.filteredBanques.slice(e,e+this.itemsPerPage)},totalPages(){return Math.ceil(this.filteredBanques.length/this.itemsPerPage)},startIndex(){return(this.currentPage-1)*this.itemsPerPage},endIndex(){return Math.min(this.startIndex+this.itemsPerPage,this.filteredBanques.length)},currentMonthYear(){const e=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];return`${e[this.currentMonth-1]} ${this.currentYear}`},canCreate(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur},canUpdate(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur},canDelete(){return this.currentUser&&"admin"===this.currentUser.type_utilisateur}},watch:{searchQuery(){this.currentPage=1},currentMonth(e,t){e!==t&&(this.currentPage=1,this.loadBanques())},currentYear(e,t){e!==t&&(this.currentPage=1,this.loadBanques())}},async mounted(){this.currentUser=Ca.getCurrentUser(),this.currentUser?(console.log("Utilisateur connect√©:",this.currentUser),this.updateCurrentDate(),await this.loadBanques(),this.interval=setInterval(this.updateCurrentDate,6e4)):this.notify({title:"Erreur",text:"Utilisateur non connect√©",type:"error"})},beforeUnmount(){this.interval&&clearInterval(this.interval)},methods:{async loadBanques(){try{this.loading=!0,this.error=null;const e=await Ee.getBanques();this.banques=e}catch(e){this.error=e.response?.data?.error||"Erreur de connexion √† l'API",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.loading=!1}},sortBy(e){this.sortField===e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortField=e,this.sortOrder="asc")},editBanque(e){this.canUpdate?(this.isEditing=!0,this.formData={...e},this.showAddModal=!0):this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour modifier les banques",type:"warning"})},confirmDelete(e){this.canDelete?(this.banqueToDelete=e,this.showDeleteModal=!0):this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour supprimer les banques",type:"warning"})},async deleteBanque(){try{this.deleting=!0,await Ee.deleteBanque(this.banqueToDelete.id_banque),await this.loadBanques(),this.showDeleteModal=!1,this.notify({title:"Succ√®s",text:"Banque supprim√©e avec succ√®s",type:"success"})}catch(e){this.error=e.response?.data?.error||"Erreur lors de la suppression",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.deleting=!1}},async saveBanque(){if(!this.isEditing||this.canUpdate)if(this.isEditing||this.canCreate)try{if(this.saving=!0,this.idError="",this.banques.some(e=>e.id_banque===this.formData.id_banque&&(!this.isEditing||e.id_banque!==this.formData.id_banque)))return void(this.idError="Cet ID banque existe d√©j√†");const e={id_banque:this.formData.id_banque,nom:this.formData.nom,section:this.formData.section};if(this.isEditing)await Ee.updateBanque(this.formData.id_banque,e),this.notify({title:"Succ√®s",text:"Banque modifi√©e avec succ√®s",type:"success"});else{const t=await Ee.createBanque(e);this.notify({title:"Succ√®s",text:`Banque cr√©√©e avec succ√®s (ID: ${t.id_banque})`,type:"success"})}await this.loadBanques(),this.closeModal()}catch(e){this.error=e.response?.data?.error||"Erreur lors de l'enregistrement",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.saving=!1}else this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour cr√©er des banques",type:"warning"});else this.notify({title:"Permission refus√©e",text:"Vous n'avez pas les droits pour modifier les banques",type:"warning"})},closeModal(){this.showAddModal=!1,this.isEditing=!1,this.formData={id_banque:null,nom:"",section:""},this.idError="",this.error=null},nextPage(){this.currentPage<this.totalPages&&!this.loading&&this.currentPage++},prevPage(){this.currentPage>1&&!this.loading&&this.currentPage--},formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit"})},updateCurrentDate(){const e=new Date,t=e.getMonth()+1,a=e.getFullYear();this.currentMonth===t&&this.currentYear===a||(this.currentMonth=t,this.currentYear=a)},prevMonth(){1===this.currentMonth?(this.currentMonth=12,this.currentYear--):this.currentMonth--,this.currentPage=1},nextMonth(){12===this.currentMonth?(this.currentMonth=1,this.currentYear++):this.currentMonth++,this.currentPage=1}}};const Sr=(0,W.A)(Pr,[["render",Br],["__scopeId","data-v-23a8c28c"]]);var Ar=Sr;const Ir={class:"statistics-page"},Xr={class:"page-content"},Fr={class:"stats-grid"},Rr={class:"stat-card"},Ur={class:"stat-number"},Qr={class:"stat-card"},Tr={class:"stat-number"},jr={class:"stat-card"},Vr={class:"stat-number"},Or={class:"stat-card"},Wr={class:"stat-number"},Nr={class:"chart-section"},Yr={key:0,class:"debug-info"};function $r(e,t,a,r,o,n){const l=(0,s.g2)("StatisticsWidget");return(0,s.uX)(),(0,s.CE)("div",Ir,[t[7]||(t[7]=(0,s.Lk)("h1",null,"üìä Statistiques",-1)),(0,s.Lk)("div",Xr,[(0,s.Lk)("div",Fr,[(0,s.Lk)("div",Rr,[t[0]||(t[0]=(0,s.Lk)("h3",null,"Total Bordereaux (historique)",-1)),(0,s.Lk)("p",Ur,(0,i.v_)(r.totalBordereauxHistorical),1),t[1]||(t[1]=(0,s.Lk)("small",null,"Depuis le d√©but",-1))]),(0,s.Lk)("div",Qr,[t[2]||(t[2]=(0,s.Lk)("h3",null,"Total Banques (historique)",-1)),(0,s.Lk)("p",Tr,(0,i.v_)(r.totalBanquesHistorical),1),t[3]||(t[3]=(0,s.Lk)("small",null,"Depuis le d√©but",-1))]),(0,s.Lk)("div",jr,[(0,s.Lk)("h3",null,"Bordereaux ("+(0,i.v_)(r.selectedPeriod)+"j)",1),(0,s.Lk)("p",Vr,(0,i.v_)(r.totalBordereauxPeriod),1),t[4]||(t[4]=(0,s.Lk)("small",null,"P√©riode r√©cente",-1))]),(0,s.Lk)("div",Or,[(0,s.Lk)("h3",null,"Banques ("+(0,i.v_)(r.selectedPeriod)+"j)",1),(0,s.Lk)("p",Wr,(0,i.v_)(r.totalBanquesPeriod),1),t[5]||(t[5]=(0,s.Lk)("small",null,"P√©riode r√©cente",-1))])]),(0,s.Lk)("div",Nr,[(0,s.Lk)("h3",null,"√âvolution sur "+(0,i.v_)(r.selectedPeriod)+" jours",1),(0,s.bF)(l,{onDataLoaded:r.handleDataLoaded,onHistoricalDataLoaded:r.handleHistoricalDataLoaded},null,8,["onDataLoaded","onHistoricalDataLoaded"])]),r.debugMode?((0,s.uX)(),(0,s.CE)("div",Yr,[t[6]||(t[6]=(0,s.Lk)("h4",null,"üìã Informations de d√©bogage :",-1)),(0,s.Lk)("p",null,"Bordereaux historiques: "+(0,i.v_)(r.totalBordereauxHistorical),1),(0,s.Lk)("p",null,"Banques historiques: "+(0,i.v_)(r.totalBanquesHistorical),1),(0,s.Lk)("p",null,"Bordereaux p√©riode: "+(0,i.v_)(r.totalBordereauxPeriod),1),(0,s.Lk)("p",null,"Banques p√©riode: "+(0,i.v_)(r.totalBanquesPeriod),1)])):(0,s.Q3)("",!0)])])}a(8237);var Kr={name:"StatisticsView",components:{StatisticsWidget:Y},setup(){const e=(0,I.KR)(0),t=(0,I.KR)(0),a=(0,I.KR)(0),r=(0,I.KR)(0),s=(0,I.KR)(7),o=(0,I.KR)(!0),n=e=>{console.log("üìä Donn√©es de p√©riode re√ßues:",e),e.bordereauData&&Array.isArray(e.bordereauData)&&(a.value=e.bordereauData.reduce((e,t)=>e+(parseInt(t.count)||0),0)),e.banqueData&&Array.isArray(e.banqueData)&&(r.value=e.banqueData.reduce((e,t)=>e+(parseInt(t.count)||0),0))},i=a=>{console.log("üìä Donn√©es historiques re√ßues:",a),a.bordereauHistorical&&Array.isArray(a.bordereauHistorical)&&(e.value=a.bordereauHistorical.length),a.banqueHistorical&&Array.isArray(a.banqueHistorical)&&(t.value=a.banqueHistorical.length)};return{totalBordereauxHistorical:e,totalBanquesHistorical:t,totalBordereauxPeriod:a,totalBanquesPeriod:r,selectedPeriod:s,debugMode:o,handleDataLoaded:n,handleHistoricalDataLoaded:i}}};const Jr=(0,W.A)(Kr,[["render",$r],["__scopeId","data-v-7aa51dfb"]]);var Hr=Jr;const zr={class:"departement-page"},Gr={class:"page-header"},Zr=["disabled"],es={class:"filters-section"},ts={class:"month-nav"},as=["disabled"],rs={class:"month-label"},ss=["disabled"],os={class:"content-section"},ns={key:0,class:"loading"},is={key:1,class:"error"},ls={key:2,class:"empty-state"},us={key:0},ds={key:1},cs=["disabled"],hs={key:3,class:"table-container"},ps={class:"departements-table"},ms={key:0,class:"sort-icon"},bs={key:0,class:"sort-icon"},vs={key:0,class:"sort-icon"},gs={key:0,class:"sort-icon"},ks={key:0,class:"sort-icon"},fs={class:"id-cell","data-label":"ID"},ys={class:"expediteur-cell","data-label":"Exp√©diteur"},Ls={class:"destination-cell","data-label":"Destination"},Ds={class:"nature-cell","data-label":"Nature"},Cs={class:"date-cell","data-label":"Date"},ws={class:"actions-cell","data-label":"Actions"},_s=["onClick","disabled"],Es=["onClick","disabled"],xs={key:0,class:"pagination"},Ms=["disabled"],qs={class:"page-info"},Bs=["disabled"],Ps={class:"pagination-info"},Ss={key:0,class:"modal-overlay"},As={class:"modal"},Is={class:"modal-header"},Xs={class:"modal-body"},Fs={class:"form-group"},Rs=["disabled"],Us={class:"form-group"},Qs=["disabled"],Ts={class:"form-group"},js=["disabled"],Vs={class:"form-group"},Os=["disabled"],Ws={class:"form-actions"},Ns=["disabled"],Ys=["disabled"],$s={key:1,class:"modal-overlay"},Ks={class:"modal delete-modal"},Js={class:"modal-header"},Hs={class:"modal-body"},zs={class:"delete-actions"},Gs=["disabled"],Zs=["disabled"];function eo(e,t,a,o,n,l){const u=(0,s.g2)("notifications");return(0,s.uX)(),(0,s.CE)("div",zr,[(0,s.Lk)("div",Gr,[t[23]||(t[23]=(0,s.Lk)("h2",null,"üìã Gestion des D√©partements",-1)),(0,s.Lk)("button",{class:"btn-primary",onClick:t[0]||(t[0]=e=>n.showAddModal=!0),disabled:n.loading},[...t[22]||(t[22]=[(0,s.Lk)("span",{class:"btn-icon"},"‚ûï",-1),(0,s.eW)(" Nouveau D√©partement ",-1)])],8,Zr)]),(0,s.Lk)("div",es,[(0,s.Lk)("div",ts,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.prevMonth&&l.prevMonth(...e)),disabled:n.loading,class:"nav-btn"},"‚¨Ö Pr√©c√©dent",8,as),(0,s.Lk)("span",rs,(0,i.v_)(l.currentMonthYear),1),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.nextMonth&&l.nextMonth(...e)),disabled:n.loading,class:"nav-btn"},"Suivant ‚û°",8,ss)])]),(0,s.Lk)("div",os,[n.loading?((0,s.uX)(),(0,s.CE)("div",ns,[...t[24]||(t[24]=[(0,s.Lk)("div",{class:"spinner"},null,-1),(0,s.Lk)("p",null,"Chargement des d√©partements...",-1)])])):n.error?((0,s.uX)(),(0,s.CE)("div",is,[t[25]||(t[25]=(0,s.Lk)("div",{class:"error-icon"},"‚ùå",-1)),t[26]||(t[26]=(0,s.Lk)("h3",null,"Erreur de chargement",-1)),(0,s.Lk)("p",null,(0,i.v_)(n.error),1),(0,s.Lk)("button",{class:"btn-retry",onClick:t[3]||(t[3]=(...e)=>l.loadDepartements&&l.loadDepartements(...e))},"R√©essayer")])):0===l.filteredDepartements.length?((0,s.uX)(),(0,s.CE)("div",ls,[t[27]||(t[27]=(0,s.Lk)("div",{class:"empty-icon"},"üìã",-1)),t[28]||(t[28]=(0,s.Lk)("h3",null,"Aucun d√©partement trouv√©",-1)),l.currentMonthYear?((0,s.uX)(),(0,s.CE)("p",us,"Aucun r√©sultat pour "+(0,i.v_)(l.currentMonthYear),1)):((0,s.uX)(),(0,s.CE)("p",ds,"Commencez par cr√©er votre premier d√©partement")),(0,s.Lk)("button",{class:"btn-primary",onClick:t[4]||(t[4]=e=>n.showAddModal=!0),disabled:n.loading}," ‚ûï Cr√©er un d√©partement ",8,cs)])):((0,s.uX)(),(0,s.CE)("div",hs,[(0,s.Lk)("table",ps,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{onClick:t[5]||(t[5]=e=>l.sortBy("id_departement")),class:"sortable"},[t[29]||(t[29]=(0,s.eW)(" ID üìä ",-1)),"id_departement"===n.sortField?((0,s.uX)(),(0,s.CE)("span",ms,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[6]||(t[6]=e=>l.sortBy("expediteur")),class:"sortable"},[t[30]||(t[30]=(0,s.eW)(" Exp√©diteur üì§ ",-1)),"expediteur"===n.sortField?((0,s.uX)(),(0,s.CE)("span",bs,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[7]||(t[7]=e=>l.sortBy("destination")),class:"sortable"},[t[31]||(t[31]=(0,s.eW)(" Destination üìç ",-1)),"destination"===n.sortField?((0,s.uX)(),(0,s.CE)("span",vs,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[8]||(t[8]=e=>l.sortBy("nature")),class:"sortable"},[t[32]||(t[32]=(0,s.eW)(" Nature üìù ",-1)),"nature"===n.sortField?((0,s.uX)(),(0,s.CE)("span",gs,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("th",{onClick:t[9]||(t[9]=e=>l.sortBy("date_creation")),class:"sortable"},[t[33]||(t[33]=(0,s.eW)(" Date üìÖ ",-1)),"date_creation"===n.sortField?((0,s.uX)(),(0,s.CE)("span",ks,(0,i.v_)("asc"===n.sortOrder?"‚Üë":"‚Üì"),1)):(0,s.Q3)("",!0)]),t[34]||(t[34]=(0,s.Lk)("th",null,"Actions",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.paginatedDepartements,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id_departement},[(0,s.Lk)("td",fs,"#"+(0,i.v_)(e.id_departement),1),(0,s.Lk)("td",ys,(0,i.v_)(e.expediteur),1),(0,s.Lk)("td",Ls,(0,i.v_)(e.destination),1),(0,s.Lk)("td",Ds,(0,i.v_)(e.nature),1),(0,s.Lk)("td",Cs,(0,i.v_)(l.formatDate(e.date_creation)),1),(0,s.Lk)("td",ws,[(0,s.Lk)("button",{class:"btn-action edit-btn",onClick:t=>l.editDepartement(e),title:"Modifier",disabled:n.loading},"‚úèÔ∏è",8,_s),(0,s.Lk)("button",{class:"btn-action delete-btn",onClick:t=>l.confirmDelete(e),title:"Supprimer",disabled:n.loading},"üóëÔ∏è",8,Es)])]))),128))])]),l.filteredDepartements.length>n.itemsPerPage?((0,s.uX)(),(0,s.CE)("div",xs,[(0,s.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>l.prevPage&&l.prevPage(...e)),disabled:1===n.currentPage||n.loading,class:"pagination-btn"},"‚Üê Pr√©c√©dent",8,Ms),(0,s.Lk)("span",qs,"Page "+(0,i.v_)(n.currentPage)+" sur "+(0,i.v_)(l.totalPages),1),(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>l.nextPage&&l.nextPage(...e)),disabled:n.currentPage===l.totalPages||n.loading,class:"pagination-btn"},"Suivant ‚Üí",8,Bs)])):(0,s.Q3)("",!0),(0,s.Lk)("div",Ps,"Affichage de "+(0,i.v_)(l.startIndex+1)+" √† "+(0,i.v_)(l.endIndex)+" sur "+(0,i.v_)(l.filteredDepartements.length)+" d√©partements",1)]))]),n.showAddModal?((0,s.uX)(),(0,s.CE)("div",Ss,[(0,s.Lk)("div",As,[(0,s.Lk)("div",Is,[(0,s.Lk)("h3",null,(0,i.v_)(n.isEditing?"Modifier":"Ajouter")+" un d√©partement",1),(0,s.Lk)("button",{class:"modal-close",onClick:t[12]||(t[12]=(...e)=>l.closeModal&&l.closeModal(...e))},"√ó")]),(0,s.Lk)("div",Xs,[(0,s.Lk)("form",{onSubmit:t[18]||(t[18]=(0,r.D$)((...e)=>l.saveDepartement&&l.saveDepartement(...e),["prevent"]))},[(0,s.Lk)("div",Fs,[t[35]||(t[35]=(0,s.Lk)("label",null,"ID D√©partement *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>n.formData.id_departement=e),type:"number",class:"form-input",required:"",disabled:n.isEditing||n.saving,min:"1",placeholder:"Entrez un ID unique"},null,8,Rs),[[r.Jo,n.formData.id_departement,void 0,{number:!0}]])]),(0,s.Lk)("div",Us,[t[37]||(t[37]=(0,s.Lk)("label",null,"Exp√©diteur *",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>n.formData.expediteur=e),class:"form-input",required:"",disabled:n.saving},[...t[36]||(t[36]=[(0,s.Lk)("option",{value:"",disabled:""},"S√©lectionner un exp√©diteur",-1),(0,s.Lk)("option",{value:"SRSP Atsimo Andrefana"},"SRSP Atsimo Andrefana",-1)])],8,Qs),[[r.u1,n.formData.expediteur]])]),(0,s.Lk)("div",Ts,[t[38]||(t[38]=(0,s.Lk)("label",null,"Destination *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>n.formData.destination=e),type:"text",placeholder:"Ex: Antananarivo",class:"form-input",required:"",disabled:n.saving,maxlength:"100"},null,8,js),[[r.Jo,n.formData.destination]])]),(0,s.Lk)("div",Vs,[t[39]||(t[39]=(0,s.Lk)("label",null,"Nature *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>n.formData.nature=e),type:"text",placeholder:"Ex: Rapport financier",class:"form-input",required:"",disabled:n.saving,maxlength:"100"},null,8,Os),[[r.Jo,n.formData.nature]])]),(0,s.Lk)("div",Ws,[(0,s.Lk)("button",{type:"button",onClick:t[17]||(t[17]=(...e)=>l.closeModal&&l.closeModal(...e)),class:"btn-cancel",disabled:n.saving},"Annuler",8,Ns),(0,s.Lk)("button",{type:"submit",class:"btn-submit",disabled:n.saving},(0,i.v_)(n.saving?"Enregistrement...":n.isEditing?"Modifier":"Cr√©er"),9,Ys)])],32)])])])):(0,s.Q3)("",!0),n.showDeleteModal?((0,s.uX)(),(0,s.CE)("div",$s,[(0,s.Lk)("div",Ks,[(0,s.Lk)("div",Js,[t[40]||(t[40]=(0,s.Lk)("h3",null,"Confirmer la suppression",-1)),(0,s.Lk)("button",{class:"modal-close",onClick:t[19]||(t[19]=e=>n.showDeleteModal=!1)},"√ó")]),(0,s.Lk)("div",Hs,[(0,s.Lk)("p",null,[t[41]||(t[41]=(0,s.eW)("√ätes-vous s√ªr de vouloir supprimer le d√©partement ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.departementToDelete?.destination),1),t[42]||(t[42]=(0,s.eW)(" (ID: ",-1)),(0,s.Lk)("strong",null,(0,i.v_)(n.departementToDelete?.id_departement),1),t[43]||(t[43]=(0,s.eW)(") ?",-1))]),t[44]||(t[44]=(0,s.Lk)("p",{class:"warning-text"},"‚ö†Ô∏è Cette action est irr√©versible !",-1)),(0,s.Lk)("div",zs,[(0,s.Lk)("button",{onClick:t[20]||(t[20]=e=>n.showDeleteModal=!1),class:"btn-cancel",disabled:n.deleting},"Annuler",8,Gs),(0,s.Lk)("button",{onClick:t[21]||(t[21]=(...e)=>l.deleteDepartement&&l.deleteDepartement(...e)),class:"btn-delete",disabled:n.deleting},(0,i.v_)(n.deleting?"Suppression...":"Supprimer"),9,Zs)])])])])):(0,s.Q3)("",!0),(0,s.bF)(u,{position:"top right"})])}var to={name:"DepartementList",setup(){const{notify:e}=(0,Da.hN)();return{notify:e}},data(){return{departements:[],loading:!0,error:null,sortField:"id_departement",sortOrder:"desc",currentPage:1,itemsPerPage:10,showAddModal:!1,showDeleteModal:!1,isEditing:!1,saving:!1,deleting:!1,formData:{id_departement:null,expediteur:"SRSP Atsimo Andrefana",destination:"",nature:""},departementToDelete:null,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),interval:null}},computed:{filteredDepartements(){return this.departements.filter(e=>{const t=new Date(e.date_creation);return t.getMonth()+1===this.currentMonth&&t.getFullYear()===this.currentYear}).sort((e,t)=>{let a="asc"===this.sortOrder?1:-1;return e[this.sortField]<t[this.sortField]?-1*a:e[this.sortField]>t[this.sortField]?1*a:0})},paginatedDepartements(){const e=(this.currentPage-1)*this.itemsPerPage;return this.filteredDepartements.slice(e,e+this.itemsPerPage)},totalPages(){return Math.ceil(this.filteredDepartements.length/this.itemsPerPage)},startIndex(){return(this.currentPage-1)*this.itemsPerPage},endIndex(){return Math.min(this.startIndex+this.itemsPerPage,this.filteredDepartements.length)},currentMonthYear(){const e=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];return`${e[this.currentMonth-1]} ${this.currentYear}`}},watch:{currentMonth(e,t){e!==t&&(this.currentPage=1)},currentYear(e,t){e!==t&&(this.currentPage=1)}},async mounted(){this.updateCurrentDate(),await this.loadDepartements(),this.interval=setInterval(this.updateCurrentDate,6e4)},beforeUnmount(){this.interval&&clearInterval(this.interval)},methods:{async loadDepartements(){try{this.loading=!0,this.error=null,this.departements=await xe.getDepartements()}catch(e){this.error=e.response?.data?.error||e.message||"Erreur de connexion √† l'API",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.loading=!1}},sortBy(e){this.sortField===e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortField=e,this.sortOrder="asc")},editDepartement(e){this.isEditing=!0,this.formData={...e},this.showAddModal=!0},confirmDelete(e){this.departementToDelete=e,this.showDeleteModal=!0},async deleteDepartement(){try{this.deleting=!0,await xe.deleteDepartement(this.departementToDelete.id_departement),await this.loadDepartements(),this.showDeleteModal=!1,this.notify({title:"Succ√®s",text:"D√©partement supprim√© avec succ√®s",type:"success"})}catch(e){this.error=e.response?.data?.error||e.message||"Erreur lors de la suppression",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.deleting=!1}},async saveDepartement(){try{if(this.saving=!0,!this.formData.id_departement||this.formData.id_departement<1)throw new Error("L'ID d√©partement doit √™tre un nombre positif");if(this.formData.destination.length>100)throw new Error("La destination d√©passe la limite de 100 caract√®res");if(this.formData.nature.length>100)throw new Error("La nature d√©passe la limite de 100 caract√®res");if(this.formData.expediteur.length>100)throw new Error("L'exp√©diteur d√©passe la limite de 100 caract√®res");const e={...this.formData};this.isEditing?(await xe.updateDepartement(e.id_departement,e),this.notify({title:"Succ√®s",text:"D√©partement modifi√© avec succ√®s",type:"success"})):(await xe.createDepartement(e),this.notify({title:"Succ√®s",text:`D√©partement cr√©√© avec succ√®s (ID: ${e.id_departement})`,type:"success"})),await this.loadDepartements(),this.closeModal()}catch(e){this.error=e.response?.data?.error||e.message||"Erreur lors de la sauvegarde",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.saving=!1}},closeModal(){this.showAddModal=!1,this.isEditing=!1,this.formData={id_departement:null,expediteur:"SRSP Atsimo Andrefana",destination:"",nature:""},this.error=null},nextPage(){this.currentPage<this.totalPages&&!this.loading&&this.currentPage++},prevPage(){this.currentPage>1&&!this.loading&&this.currentPage--},formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit"})},updateCurrentDate(){const e=new Date,t=e.getMonth()+1,a=e.getFullYear();this.currentMonth===t&&this.currentYear===a||(this.currentMonth=t,this.currentYear=a)},prevMonth(){1===this.currentMonth?(this.currentMonth=12,this.currentYear--):this.currentMonth--,this.currentPage=1},nextMonth(){12===this.currentMonth?(this.currentMonth=1,this.currentYear++):this.currentMonth++,this.currentPage=1}}};const ao=(0,W.A)(to,[["render",eo],["__scopeId","data-v-0a63e2ae"]]);var ro=ao;const so={class:"login-container"},oo={class:"login-right"},no={class:"login-form-container"},io={class:"input-group"},lo={class:"input-group"},uo=["type"],co=["title"],ho={class:"form-options"},po={class:"checkbox-container"},mo=["disabled"],bo={key:0,class:"btn-spinner"},vo={key:0,class:"error-message"},go={key:0,class:"custom-notification"},ko={class:"notification-header"},fo={class:"demo-section"};function yo(e,t,a,o,n,l){return(0,s.uX)(),(0,s.CE)("div",so,[t[26]||(t[26]=(0,s.Lk)("div",{class:"login-left"},[(0,s.Lk)("div",{class:"background-overlay"}),(0,s.Lk)("div",{class:"welcome-content"},[(0,s.Lk)("h1",null,"Bienvenue sur CoachPro"),(0,s.Lk)("p",null,"G√©rez vos bordereaux financiers en toute simplicit√©")])],-1)),(0,s.Lk)("div",oo,[(0,s.Lk)("div",no,[t[24]||(t[24]=(0,s.Lk)("div",{class:"form-header"},[(0,s.Lk)("h2",null,"Connexion"),(0,s.Lk)("p",null,"Acc√©dez √† votre espace personnel")],-1)),(0,s.Lk)("form",{onSubmit:t[10]||(t[10]=(0,r.D$)((...e)=>o.handleLogin&&o.handleLogin(...e),["prevent"])),class:"login-form"},[(0,s.Lk)("div",io,[t[13]||(t[13]=(0,s.Lk)("label",{for:"email",class:"input-label"},"Adresse Email",-1)),(0,s.Lk)("div",{class:(0,i.C4)(["input-wrapper",{focused:o.emailFocused}])},[t[11]||(t[11]=(0,s.Lk)("span",{class:"input-icon"},"üìß",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>o.loginData.email=e),class:"form-input",placeholder:"Entrez votre email",required:"",onFocus:t[1]||(t[1]=e=>o.emailFocused=!0),onBlur:t[2]||(t[2]=e=>o.emailFocused=!1),ref:"emailInput"},null,544),[[r.Jo,o.loginData.email]]),t[12]||(t[12]=(0,s.Lk)("div",{class:"input-border"},null,-1))],2)]),(0,s.Lk)("div",lo,[t[16]||(t[16]=(0,s.Lk)("label",{for:"password",class:"input-label"},"Mot de passe",-1)),(0,s.Lk)("div",{class:(0,i.C4)(["input-wrapper",{focused:o.passwordFocused}])},[t[14]||(t[14]=(0,s.Lk)("span",{class:"input-icon"},"üîí",-1)),(0,s.bo)((0,s.Lk)("input",{type:o.showPassword?"text":"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>o.loginData.password=e),class:"form-input",placeholder:"Entrez votre mot de passe",required:"",onFocus:t[4]||(t[4]=e=>o.passwordFocused=!0),onBlur:t[5]||(t[5]=e=>o.passwordFocused=!1),ref:"passwordInput"},null,40,uo),[[r.hp,o.loginData.password]]),(0,s.Lk)("button",{type:"button",class:"password-toggle",onClick:t[6]||(t[6]=e=>o.showPassword=!o.showPassword),title:o.showPassword?"Cacher le mot de passe":"Afficher le mot de passe"},(0,i.v_)(o.showPassword?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"),9,co),t[15]||(t[15]=(0,s.Lk)("div",{class:"input-border"},null,-1))],2)]),(0,s.Lk)("div",ho,[(0,s.Lk)("label",po,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>o.rememberMe=e)},null,512),[[r.lH,o.rememberMe]]),t[17]||(t[17]=(0,s.Lk)("span",{class:"checkmark"},null,-1)),t[18]||(t[18]=(0,s.eW)(" Se souvenir de moi ",-1))]),t[19]||(t[19]=(0,s.Lk)("a",{href:"#",class:"forgot-password"},"Mot de passe oubli√© ?",-1))]),(0,s.Lk)("button",{type:"submit",class:"login-btn",disabled:o.loading},[o.loading?((0,s.uX)(),(0,s.CE)("span",bo)):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,i.v_)(o.loading?"CONNEXION...":"SE CONNECTER"),1)],8,mo),o.errorMessage?((0,s.uX)(),(0,s.CE)("div",vo,(0,i.v_)(o.errorMessage),1)):(0,s.Q3)("",!0),(0,s.bF)(r.eB,{name:"notification-slide"},{default:(0,s.k6)(()=>[o.showNotification?((0,s.uX)(),(0,s.CE)("div",go,[(0,s.Lk)("div",ko,[t[20]||(t[20]=(0,s.Lk)("span",{class:"notification-icon"},"üîí",-1)),t[21]||(t[21]=(0,s.Lk)("span",{class:"notification-title"},"Acc√®s Anticip√©",-1)),(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>o.closeNotification&&o.closeNotification(...e)),class:"notification-close"},"√ó")]),t[22]||(t[22]=(0,s.Lk)("div",{class:"notification-message"}," Veuillez vous connecter avec vos identifiants pour acc√©der au tableau de bord. La d√©mo est temporairement d√©sactiv√©e pour des raisons de s√©curit√©. ",-1)),t[23]||(t[23]=(0,s.Lk)("div",{class:"notification-progress"},null,-1))])):(0,s.Q3)("",!0)]),_:1}),(0,s.Lk)("div",fo,[(0,s.Lk)("button",{type:"button",onClick:t[9]||(t[9]=(...e)=>o.handleDemoClick&&o.handleDemoClick(...e)),class:"demo-btn"}," üöÄ Acc√©der au tableau de bord (d√©mo) ")])],32),t[25]||(t[25]=(0,s.Lk)("div",{class:"login-footer"},[(0,s.Lk)("p",null,"¬© 2024 CoachPro. Tous droits r√©serv√©s.")],-1))])])])}var Lo={name:"LoginPage",setup(){const e=(0,n.rd)(),t=(0,I.KR)({email:"",password:""}),a=(0,I.KR)(!1),r=(0,I.KR)(!1),o=(0,I.KR)(!1),i=(0,I.KR)(!1),l=(0,I.KR)(!1),u=(0,I.KR)(""),d=(0,I.KR)(!1),c=(0,I.KR)(null),h=(0,I.KR)(null);(0,s.sV)(()=>{p(),!t.value.email&&c.value&&(0,s.dY)(()=>{c.value.focus()})});const p=()=>{const e="true"===localStorage.getItem("rememberMe"),r=localStorage.getItem("savedEmail"),s=localStorage.getItem("savedPassword");e&&r&&(a.value=!0,t.value.email=r,s&&(t.value.password=s),console.log("üîê Identifiants charg√©s depuis la m√©moire"))},m=()=>{a.value?(localStorage.setItem("rememberMe","true"),localStorage.setItem("savedEmail",t.value.email),localStorage.setItem("savedPassword",t.value.password),console.log("üíæ Identifiants sauvegard√©s")):(localStorage.removeItem("rememberMe"),localStorage.removeItem("savedEmail"),localStorage.removeItem("savedPassword"),console.log("üóëÔ∏è Identifiants supprim√©s de la m√©moire"))},b=async()=>{if(u.value="",t.value.email&&t.value.password){r.value=!0;try{const a=await we.login(t.value.email,t.value.password);a.success?(localStorage.setItem("isAuthenticated","true"),localStorage.setItem("userEmail",t.value.email),localStorage.setItem("userData",JSON.stringify(a.user)),m(),e.push("/home")):u.value=a.error||"Email ou mot de passe incorrect"}catch(a){console.error("Erreur de connexion:",a),u.value=a.message||"Erreur de connexion au serveur."}finally{r.value=!1}}else u.value="Veuillez remplir tous les champs"},v=()=>{d.value=!0;const e=document.querySelector(".demo-btn");e&&(e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform=""},150)),setTimeout(()=>{g()},5e3),console.log("üö´ Tentative d'acc√®s d√©mo bloqu√©e avec notification personnalis√©e")},g=()=>{d.value=!1};return{loginData:t,rememberMe:a,loading:r,showPassword:o,emailFocused:i,passwordFocused:l,errorMessage:u,showNotification:d,emailInput:c,passwordInput:h,handleLogin:b,handleDemoClick:v,closeNotification:g}}};const Do=(0,W.A)(Lo,[["render",yo],["__scopeId","data-v-c5b26826"]]);var Co=Do;const wo={class:"search-by-date-page"},_o={class:"search-form"},Eo={class:"form-group"},xo=["max"],Mo={class:"form-group"},qo=["disabled"],Bo={key:0,class:"results-section"},Po={key:1,class:"results-section"},So={class:"error-message"},Ao={key:2,class:"results-section"},Io={key:3,class:"results-section"},Xo={class:"results-table"},Fo={key:0},Ro={key:1},Uo={key:2},Qo={key:3},To={key:4},jo={key:5},Vo={key:6},Oo={key:7},Wo={key:0},No={key:1},Yo={key:2},$o={key:3},Ko={key:4},Jo={key:5},Ho={key:6},zo={key:7};function Go(e,t,a,o,n,l){return(0,s.uX)(),(0,s.CE)("div",wo,[t[9]||(t[9]=(0,s.Lk)("div",{class:"page-header"},[(0,s.Lk)("h2",null,"üîç Recherche par Date")],-1)),(0,s.Lk)("div",_o,[(0,s.Lk)("div",Eo,[t[3]||(t[3]=(0,s.Lk)("label",{for:"search-date"},"Choisir une date :",-1)),(0,s.bo)((0,s.Lk)("input",{id:"search-date","onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedDate=e),type:"date",class:"form-input",max:n.maxDate,required:""},null,8,xo),[[r.Jo,n.selectedDate]])]),(0,s.Lk)("div",Mo,[t[5]||(t[5]=(0,s.Lk)("label",{for:"search-type"},"Type de recherche :",-1)),(0,s.bo)((0,s.Lk)("select",{id:"search-type","onUpdate:modelValue":t[1]||(t[1]=e=>n.searchType=e),class:"form-input",required:""},[...t[4]||(t[4]=[(0,s.Lk)("option",{value:"",disabled:""},"S√©lectionner un type",-1),(0,s.Lk)("option",{value:"bordereaux"},"Bordereaux",-1),(0,s.Lk)("option",{value:"banques"},"Banques",-1)])],512),[[r.u1,n.searchType]])]),(0,s.Lk)("button",{class:"btn-search",onClick:t[2]||(t[2]=(...e)=>l.searchByDate&&l.searchByDate(...e)),disabled:!n.selectedDate||!n.searchType}," Rechercher ",8,qo)]),n.loading?((0,s.uX)(),(0,s.CE)("div",Bo,[...t[6]||(t[6]=[(0,s.Lk)("div",{class:"spinner"},null,-1),(0,s.Lk)("p",null,"Chargement des r√©sultats...",-1)])])):n.error?((0,s.uX)(),(0,s.CE)("div",Po,[(0,s.Lk)("p",So,(0,i.v_)(n.error),1)])):0!==n.results.length||n.loading?((0,s.uX)(),(0,s.CE)("div",Io,[(0,s.Lk)("h3",null,"R√©sultats pour le "+(0,i.v_)(l.formattedDate),1),(0,s.Lk)("table",Xo,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,["bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Fo,"ID Bordereau")):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Ro,"Matricule")):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Uo,"R√©f√©rence")):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Qo,"Objet")):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("th",To,"Statut")):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("th",jo,"ID Banque")):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Vo,"Nom")):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("th",Oo,"Section")):(0,s.Q3)("",!0),t[8]||(t[8]=(0,s.Lk)("th",null,"Date Cr√©ation",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.results,(e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},["bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("td",Wo,(0,i.v_)(e.id_bordereau),1)):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("td",No,(0,i.v_)(e.matricule),1)):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("td",Yo,(0,i.v_)(e.reference),1)):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("td",$o,(0,i.v_)(e.objet),1)):(0,s.Q3)("",!0),"bordereaux"===n.searchType?((0,s.uX)(),(0,s.CE)("td",Ko,(0,i.v_)(e.statut),1)):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("td",Jo,(0,i.v_)(e.id_banque),1)):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("td",Ho,(0,i.v_)(e.nom),1)):(0,s.Q3)("",!0),"banques"===n.searchType?((0,s.uX)(),(0,s.CE)("td",zo,(0,i.v_)(e.section),1)):(0,s.Q3)("",!0),(0,s.Lk)("td",null,(0,i.v_)(l.formatDate(e.date_creation)),1)]))),128))])])])):((0,s.uX)(),(0,s.CE)("div",Ao,[...t[7]||(t[7]=[(0,s.Lk)("p",null,"Aucun r√©sultat trouv√© pour la date s√©lectionn√©e.",-1)])]))])}var Zo={name:"SearchByDate",setup(){const{notify:e}=(0,Da.hN)();return{notify:e}},data(){return{selectedDate:"",searchType:"",results:[],loading:!1,error:null,maxDate:(new Date).toISOString().split("T")[0]}},computed:{formattedDate(){if(!this.selectedDate)return"";const e=new Date(this.selectedDate);return e.toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}},methods:{async searchByDate(){try{this.loading=!0,this.error=null,this.results=await Me.searchByDate(this.selectedDate,this.searchType),0===this.results.length?this.notify({title:"Avertissement",text:"Aucun r√©sultat trouv√© pour cette date.",type:"warning"}):this.notify({title:"Succ√®s",text:`${this.results.length} r√©sultat(s) trouv√©(s).`,type:"success"})}catch(e){this.error=e.response?.data?.error||e.message||"Erreur lors de la recherche",this.notify({title:"Erreur",text:this.error,type:"error"})}finally{this.loading=!1}},formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit"})}}};const en=(0,W.A)(Zo,[["render",Go],["__scopeId","data-v-70e1411c"]]);var tn=en;const an=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:Co,meta:{title:"Connexion - CoachPro",layout:"auth",requiresAuth:!1}},{path:"/home",name:"Home",component:Pe,meta:{title:"Accueil - CoachPro",layout:"default",requiresAuth:!0}},{path:"/bordereaux",name:"Bordereaux",component:Ea,meta:{title:"Bordereaux - CoachPro",layout:"default",requiresAuth:!0}},{path:"/banque",name:"Banque",component:Ar,meta:{title:"Banques - CoachPro",layout:"default",requiresAuth:!0}},{path:"/statistiques",name:"Statistiques",component:Hr,meta:{title:"Statistiques - CoachPro",layout:"default",requiresAuth:!0}},{path:"/departement",name:"Departement",component:ro,meta:{title:"D√©partements - CoachPro",layout:"default",requiresAuth:!0}},{path:"/search-by-date",name:"SearchByDate",component:tn,meta:{title:"Recherche par Date - CoachPro",layout:"default",requiresAuth:!0}}],rn=(0,n.aE)({history:(0,n.LA)("/bordereau/"),routes:an});rn.beforeEach((e,t,a)=>{const r="true"===localStorage.getItem("isAuthenticated");console.log("üîÑ Navigation:",{from:t.path,to:e.path,authenticated:r,requiresAuth:e.meta.requiresAuth}),document.title=e.meta.title||"CoachPro - Dashboard",e.meta.requiresAuth&&!r?(console.log("‚ùå Acc√®s refus√© - Redirection vers /login"),a("/login")):"/login"===e.path&&r?(console.log("‚úÖ D√©j√† authentifi√© - Redirection vers /home"),a("/home")):(console.log("‚úÖ Acc√®s autoris√©"),a())});var sn=rn;const on="true"===localStorage.getItem("isAuthenticated");console.log("üîê Statut authentification au d√©marrage:",on);const nn=(0,r.Ef)(re);nn.use(sn),nn.use(Da.Ay),console.log("üöÄ Application Vue mont√©e"),nn.mount("#app")}},t={};function a(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,r,s,o){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],s=e[d][1],o=e[d][2];for(var i=!0,l=0;l<r.length;l++)(!1&o||n>=o)&&Object.keys(a.O).every(function(e){return a.O[e](r[l])})?r.splice(l--,1):(i=!1,o<n&&(n=o));if(i){e.splice(d--,1);var u=s();void 0!==u&&(t=u)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,s,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,o,n=r[0],i=r[1],l=r[2],u=0;if(n.some(function(t){return 0!==e[t]})){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(l)var d=l(a)}for(t&&t(r);u<n.length;u++)o=n[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],function(){return a(5151)});r=a.O(r)})();
//# sourceMappingURL=app.ff0e298a.js.map